\documentclass[12pt]{article}
\author{Matthew D. Cocci}
\title{Homework 11}
\date{\today}
%% Formatting & Spacing %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry} % most detailed page formatting control
\usepackage{fullpage} % Simpler than using the geometry package; std effect
\usepackage{setspace}
%\onehalfspacing
\usepackage{microtype}


%% Header %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{fancyhdr}
%\pagestyle{fancy}
%\lhead{}
%\rhead{}
%\chead{}
%\setlength{\headheight}{15.2pt}
    %---Make the header bigger to avoid overlap

%\renewcommand{\headrulewidth}{0.3pt}
    %---Width of the line

%\setlength{\headsep}{0.2in}
    %---Distance from line to text


%% Mathematics Related %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm} %allows for labeling of theorems
\usepackage{accents}
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{ex}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}

% Below supports left-right alignment in matrices so the negative
% signs don't look bad
\makeatletter
\renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols #1}}
\makeatother


%% Font Choices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
%\usepackage{blindtext}


%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{graphicx}
\usepackage{subfigure}
    %---For plotting multiple figures at once
%\graphicspath{ {Directory/} }
    %---Set a directory for where to look for figures


%% Hyperlinks %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hyperref}
\hypersetup{
    colorlinks,
        %---This colors the links themselves, not boxes
    citecolor=black,
        %---Everything here and below changes link colors
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%% Including Code %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{verbatim}
    %---For including verbatim code from files, no colors

\usepackage{listings}
\usepackage{color}
\definecolor{mygreen}{RGB}{28,172,0}
\definecolor{mylilas}{RGB}{170,55,241}
\newcommand{\matlabcode}[1]{%
    \lstset{language=Matlab,%
        basicstyle=\footnotesize,%
        breaklines=true,%
        morekeywords={matlab2tikz},%
        keywordstyle=\color{blue},%
        morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},%
        identifierstyle=\color{black},%
        stringstyle=\color{mylilas},%
        commentstyle=\color{mygreen},%
        showstringspaces=false,%
            %---Without this there will be a symbol in
            %---the places where there is a space
        numbers=left,%
        numberstyle={\tiny \color{black}},%
            %---Size of the numbers
        numbersep=9pt,%
            %---Defines how far the numbers are from the text
        emph=[1]{for,end,break,switch,case},emphstyle=[1]\color{red},%
            %---Some words to emphasise
    }%
    \lstinputlisting{#1}
}
    %---For including Matlab code from .m file with colors,
    %---line numbering, etc.

%% Bibliographies %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{natbib}
    %---For bibliographies
%\setlength{\bibsep}{3pt} % Set how far apart bibentries are

%% Misc %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{enumitem}
    %---Has to do with enumeration
\usepackage{appendix}
\usepackage{pdfpages}
    %---For including whole pdf pages as a page in doc


%% User Defined %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\nameofcmd}{Text to display}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% BODY %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle

%\tableofcontents


\begin{enumerate}
  \item % Question 1
  \item % Question 2
    Throughout this question, $W_t$ is Brownian mtion starting at
    $W_0=0$. In addition
    \begin{align*}
      \tau_n = \inf \{t \; | \; W_t \not\in [-n,1]\}
    \end{align*}
    \begin{enumerate}
      \item % Question 2a
        We want to calculate $E\tau_n$. We saw in class that if we let
        $T_1(x) = E[\tau_n | W_0=x]$, this must satisify
        \begin{align*}
          \mathscr{L}T_1 = -1
          \qquad \text{s.t.}
          \begin{cases}
            T_1(-n) = 0 \\
            T_1(1)=0
          \end{cases}
        \end{align*}
        where $\mathscr{L}$ is the generator of the process. But since
        the process is simple Brownian motion, this reduces to
        \begin{align*}
          -1 = \mathscr{L}T_1
          &= 0 \cdot \frac{\partial T_1}{\partial x}
          + \frac{1}{2} 1\cdot \frac{\partial^2 T_1}{\partial x^2}\\
          \Rightarrow\qquad
          -1 &= \frac{1}{2} \frac{\partial^2 T_1}{\partial x^2}\\
          \Leftrightarrow\qquad
          -2 &= \frac{\partial^2 T_1}{\partial x^2}
        \end{align*}
        Solving this equation gives
        \begin{align*}
          T_1(x) &= -x^2 + Cx + D
        \end{align*}
        Using the boundary conditions gives
        \begin{align*}
          0 &= -(-n)^2 + C(-n) + D
          \;\;\quad \Rightarrow
          C = 1-n\\
          0 &= -(1)^2 + C(1) + D \quad\qquad\qquad
          D = n\\\\
          \Rightarrow \quad
          T_1(x) &= -x^2 + (1-n)x + n
        \end{align*}
        Starting at initial value of 0,
        \begin{align*}
          \mathbb{E}\tau_n = T_1(0) = n
        \end{align*}

      \item % Question 2b
        We will solve for $q(x) = P(\text{Brownian Motion Hits $-n$
        before 1})$ by solving
        \begin{align*}
          \frac{\partial^2 q}{\partial x^2}
          &= 0
          \qquad
          \text{s.t.}
          \begin{cases}
            q(-n) = 1 \\
            q(1)  = 0 \\
          \end{cases}
        \end{align*}
        Solving for $q(x)$ gives
        \begin{align*}
          q(x) &= Cx + D
        \end{align*}
        Substituting in boundary conditions gives
        \begin{align*}
          1 &= C(-n) + D
          \quad \Rightarrow \quad
          C = -\frac{1}{(n+1)}\\
          0 &= C + D
          \quad\qquad\qquad\quad
          D = \frac{1}{(n+1)}
        \end{align*}
        Therefore,
        \begin{align*}
          q(x) &= -\frac{1}{(n+1)}\cdot x + \frac{1}{(n+1)}\\
               &= \frac{1-x}{(n+1)}
        \end{align*}
        Given a starting point of zero, the result becomes:
        \begin{align*}
          q(0) &= \frac{1}{n+1}
        \end{align*}
        Intuitively, this makes a lot of sense. For $n=1$, the interval
        is symmetric, and exiting at $-1$ is equally as likely as
        exiting at 1. Morover, the probability of exiting at $-n$
        decreases with $n$. These are both exactly as we would expect.

      \item % Question 2c
        To compute the expectation $\mathbb{E}W_{\tau_n}$ directly,
        notice that $W_{\tau_n}$ can only take on one of two values:
        $-n$ or $1$. Moreover, the previous question pinned down the
        probabilities of these objects, giving
        \begin{align*}
          \mathbb{E}W_{\tau_n}
          &=
          \left(\frac{1}{n+1}\right)(-n)
          + \left(1-\frac{1}{n+1}\right)\cdot 1\\
          &=
          -\frac{n}{n+1}
          + \frac{n+1 - 1}{n+1}\\
          &= 0
        \end{align*}
    \end{enumerate}

  \item % Question 3
    Where $T_n(x):=E[T^n|X_0=x]$, we want to show that $T_n$ satisfies
    \begin{align*}
      \mathscr{L}T_n = -n T_{n-1} \qquad T_n(\partial D)=0
    \end{align*}
    Very similar to the notes, where $n=1$, start with the fact that
    $-\partial_t G$ is the pdf of $T$; therefore, by definition
    \begin{align*}
      T_n(x)=\mathbb{E}[T^n|X_0=x]
      &= -\int^\infty_0 t^n \frac{\partial G}{\partial t} dt\\
      \text{Int.\ by Parts and L'Hospital's Rule} \qquad
      &= \int^\infty_0 n t^{n-1} G \; dt
    \end{align*}
    We could apply L'Hospital's rule multiple times because the function
    $G(x,t)$ flat at 0 as $t\rightarrow\infty$, so derivatives of $G$
    become 0 at infinity. From there, apply the operator, use the fact
    that it commutes, and use the definition of $T_{n-1}(x)$ and the
    backward equation to get
    \begin{align*}
      \mathscr{L}T_n(x)=
      &= \mathscr{L}\int^\infty_0 n t^{n-1} G \; dt
      = n\int^\infty_0  t^{n-1} \mathscr{L}G \; dt\\
      &= n\int^\infty_0  t^{n-1} \partial_tG \; dt\\
      &= n(-\mathbb{E}[T^{n-1}|X_0=x])\\
      \Rightarrow\qquad
      \mathscr{L}T_n=
      &= -nT_{n-1}
    \end{align*}

  \end{enumerate}

\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% SAMPLE CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    %% BIBLIOGRAPHIES %%

        \cite{LabelInSourcesFile}  %Use in text; cites
        \citep{LabelInSourcesFile} %Use in text; cites in parens

        \nocite{LabelInSourceFile} % Includes in refs w/o specific citation
        \bibliographystyle{apalike}  % Or some other style

        % To ditch the ``References'' header
        \begingroup
        \renewcommand{\section}[2]{}
        \endgroup

        \bibliography{sources} % where sources.bib has all the citation info

    %% SPACING %%

        \vspace{1in}
        \hspace{1in}


    %% INCLUDING PDF PAGE %%

        \includepdf{file.pdf}


    %% INCLUDING CODE %%

        \verbatiminput{file.ext}
            %---Includes verbatim text from the file
        \texttt{text}
            %---Renders text in courier, or code-like, font

        \matlabcode{file.m}
            %---Includes Matlab code with colors and line numbers


    %% INCLUDING FIGURES %%

        % Basic Figure with size scaling
            \begin{figure}[h!]
               \centering
               \includegraphics[scale=1]{file.pdf}
            \end{figure}

        % Basic Figure with specific height
            \begin{figure}[h!]
               \centering
               \includegraphics[height=5in, width=5in]{file.pdf}
            \end{figure}

        % Figure with cropping, where the order for trimming is  L, B, R, T
            \begin{figure}
               \centering
               \includegraphics[trim={1cm, 1cm, 1cm, 1cm}, clip]{file.pdf}
            \end{figure}


        % Side by Side figures
            \begin{figure}[h!]
                \centering
                \mbox{\subfigure{
                    \includegraphics[scale=1]{file1.pdf}
                }\quad\subfigure{
                    \includegraphics[scale=1]{file2.pdf}
                }
                }
            \end{figure}


