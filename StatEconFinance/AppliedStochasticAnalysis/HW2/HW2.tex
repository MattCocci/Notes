\documentclass[12pt]{article}

\author{Matthew D. Cocci}
\title{Homework 2}
\date{\today}

%% Formatting & Spacing %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry} % most detailed page formatting control
\usepackage{fullpage} % Simpler than using the geometry package; std effect
\usepackage{setspace}
%\onehalfspacing
\usepackage{microtype}


%% Header %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{fancyhdr} 
%\pagestyle{fancy} 
%\lhead{}
%\rhead{}
%\chead{}
%\setlength{\headheight}{15.2pt} 
    %---Make the header bigger to avoid overlap

%\renewcommand{\headrulewidth}{0.3pt} 
    %---Width of the line

%\setlength{\headsep}{0.2in}    
    %---Distance from line to text
            

%% Mathematics Related %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm} %allows for labeling of theorems
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{ex}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}

% Below supports left-right alignment in matrices so the negative
% signs don't look bad
\makeatletter
\renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols #1}}
\makeatother


%% Font Choices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
%\usepackage{blindtext}


%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{graphicx}
\usepackage{subfigure} 
    %---For plotting multiple figures at once
%\graphicspath{ {Directory/} }
    %---Set a directory for where to look for figures


%% Hyperlinks %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hyperref} 
\hypersetup{	
    colorlinks,		
        %---This colors the links themselves, not boxes
    citecolor=black,	
        %---Everything here and below changes link colors
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%% Including Code %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\usepackage{verbatim} 
    %---For including verbatim code from files, no colors

\usepackage{listings}
\usepackage{color}
\definecolor{mygreen}{RGB}{28,172,0}
\definecolor{mylilas}{RGB}{170,55,241}
\newcommand{\matlabcode}[1]{%
    \lstset{language=Matlab,%
        basicstyle=\footnotesize,%
        breaklines=true,%
        morekeywords={matlab2tikz},%
        keywordstyle=\color{blue},%
        morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},%
        identifierstyle=\color{black},%
        stringstyle=\color{mylilas},%
        commentstyle=\color{mygreen},%
        showstringspaces=false,%
            %---Without this there will be a symbol in 
            %---the places where there is a space
        numbers=left,%
        numberstyle={\tiny \color{black}},% 
            %---Size of the numbers
        numbersep=9pt,% 
            %---Defines how far the numbers are from the text
        emph=[1]{for,end,break,switch,case},emphstyle=[1]\color{red},%
            %---Some words to emphasise
    }%
    \lstinputlisting{#1}
}
    %---For including Matlab code from .m file with colors,
    %---line numbering, etc. 

%% Bibliographies %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%\usepackage{natbib} 
    %---For bibliographies
%\setlength{\bibsep}{3pt} % Set how far apart bibentries are

%% Misc %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\usepackage{enumitem} 
    %---Has to do with enumeration	
\usepackage{appendix}
\usepackage{pdfpages}
    %---For including whole pdf pages as a page in doc


%% User Defined %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%\newcommand{\nameofcmd}{Text to display}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%% BODY %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 


\begin{document}
\maketitle

%\tableofcontents 

\begin{enumerate}

\item % Question 1
\begin{enumerate}
  \item % Question 1a
    Yes. The transition matrix $P$ has transition probabilities
    \begin{equation}
      p_{ij} = 
        \begin{cases}
          0 & j < i\\
          i/6 & j = i\\
          1/6 & j > i\\
        \end{cases}
    \end{equation}
    Written out, $P$ is
    \begin{align*}
      \begin{pmatrix}
        1/6 & 1/6 & 1/6 & 1/6 & 1/6 & 1/6 \\
        0   & 2/6 & 1/6 & 1/6 & 1/6 & 1/6 \\
        0   & 0   & 3/6 & 1/6 & 1/6 & 1/6 \\
        0   & 0   & 0   & 4/6 & 1/6 & 1/6 \\
        0   & 0   & 0   & 0   & 5/6 & 1/6 \\
        0   & 0   & 0   & 0   & 0   & 1 \\
      \end{pmatrix}
    \end{align*}

  \item % Question 1b
    No, this is not a Markov Chain. You need to keep track of the
    previous 5 rolls. 

  \item % Question 1c
    Yes. The transition matrix $P$ has transition probabilities
    \begin{align*}
      p_{ij} = 
        \begin{cases}
          0 & j < i\\
          5/6 & j = i\\
          1/6 & j > i\\
        \end{cases}
    \end{align*}

  \item % Question 1d
    Yes. Letting $C_r=0$ denote that a six has been thrown at time $r$,
    the transition matrix $P$ has transition probabilities
    \begin{align*}
      p_{ij} = 
        \begin{cases}
          1/6 & j=0\\
          5/6 & j=i+1\\
          0 & j=1,\ldots,i,i+2,\ldots,r\\
        \end{cases}
    \end{align*}

  \item % Question 1e
%    Somewhat. It is true that $B_r$ satisfies the Markov Property:
%    \begin{align*}
%      P(B_r|B_{r-1},\ldots,B_0) =
%      P(B_r|B_{r-1})
%    \end{align*}
%    However, it is also true that
%    \begin{align*}
%      P(B_r) = P(B_r|B_{r-1},\ldots,B_0) =
%      P(B_r|B_{r-1})
%    \end{align*}
%    In other words, the history is entirely irrelevant
\end{enumerate} % End question 1

\item % Question 2
  To show that vector $v$ with properties $v_ip_{ij}=v_jp_{ji}$
  ($\forall i,j$) is a stationary distribution for the primitive Markov
  Chain with transition matrix $P$, it must be shown that
  \begin{enumerate}
    \item[(i)] $v_j \geq 0$ and $\sum_j v_j=1$
    \item[(ii)] $v = vP$
  \end{enumerate}
  \begin{proof}[Proof of (i)]
  Note first that $\sum_j v_j = 1$ since that is a condition of being a
  distribution (otherwise rescale so that the elements sum to 1). Then
  recall the detailed balance condition:
  \begin{align}
    \label{q2.dbcond}
    v_i p_{ij} &= v_j p_{ji}
  \end{align}
  Fix $i$ and suppose that $v_i < 0$. Since $p_{ij}$ and $p_{ji}$ are
  non-negative transition probabilities, $v_j < 0$ as well for all $j$
  (since detailed balance requires Condition~\ref{q2.dbcond}) to hold
  for all $i,j$ combinations.

  Then since all elements of $v$ are negative, $\sum_j v_j < 0$, which
  is a contradiction, since $\sum_j v_j = 1$ because $v$ is a
  distribution.
  \end{proof}

  \begin{proof}[Proof of (ii)] First, let's use the condition for
    detailed balance:
    \begin{align*}
      \text{Assumed} \qquad \quad v_i p_{ij} &= v_j p_{ji} \\
      \text{Sum over $j$} \qquad \sum_j v_i p_{ij} &= \sum_j v_j p_{ji} \\
       v_i\sum_j  p_{ij} &= \sum_j v_j p_{ji}
    \end{align*}
    Now since $P$ is a stochastic matrix, $\sum_j p_{ij}=1$ by
    definition. Moreover, the righthand side is simply the the dot
    product of $v$ and the $i$th column of $P$.  Hence
    \begin{equation}
      \label{q2.vi}
      v_i = \sum_j v_j p_{ji} = v P_{\cdot i}
    \end{equation}
    Hence, we can write
    \begin{align*}
      v =
      \begin{pmatrix}
        v_1 & \cdots & v_n
      \end{pmatrix} =
      \begin{pmatrix}
        v P_{\cdot 1} & v P_{\cdot 2} & \cdots & v P_{\cdot n}
      \end{pmatrix}
        = vP
    \end{align*}
  \end{proof}
  Hence $v$ is a stationary distribution.

\item % Question 3
  To get a first guess at the stationary distribution, suppose that the
  particles were simply randomly distributed. Then a good starting guess
  for the stationary distribution would be the binomial distribution,
  where $v_i$ (the probability that $i$ of $m$ particles that are on the
  left hand side) can be written
  \begin{align}
    v_i = \binom{m}{i} \left(\frac{1}{2}\right)^i
      \left(\frac{1}{2}\right)^{m-i} =
      \frac{m!}{i!(m-i)!} \left(\frac{1}{2}\right)^m
      \label{q3.v}
  \end{align}
  We now check that this satisfies detailed balance, where the
  transition probabilities are given in the problem setup. First, we
  look at the transition from $i$ to $j=i+1$:
  \begin{align*}
    v_i p_{i,i+1}
      &= \frac{m!}{i!(m-i)!} \left(\frac{1}{2}\right)^m
        \left(1-\frac{i}{m}\right)\\
      &= \frac{m!}{i!(m-i)!} \left(\frac{1}{2}\right)^m
        \left(\frac{m-i}{m}\right)\\
      &= \frac{m!}{i!(m-(i+1))!} \left(\frac{1}{2}\right)^m
        \left(\frac{1}{m}\right)\\
      &= \frac{(i+1)m!}{(i+1)i!(m-(i+1))!} \left(\frac{1}{2}\right)^m
        \left(\frac{1}{m}\right)\\
      &= \frac{m!}{(i+1)!(m-(i+1))!} \left(\frac{1}{2}\right)^m
        \left(\frac{i+1}{m}\right)\\
      &= v_{i+1} p_{i+1,i}
  \end{align*}
  The transition from $i$ to $j=i-1$ also satisfies detailed balance,
  since we can just apply the above result in reverse, shifting the
  indices by 1. Lastly, the transition probabilities from $i$ to
  $j\not\in\{i-1,i+1\}$ (and in the opposite direction) are zero for all
  such $j$, as only one particle moves at a time.

  To show that this is the stationary distribution, first note that $v$
  is the binomial distribution, so the elements must sum to 1. Also,
  $v_i>0$ for all $i=1,\ldots,m$. Lastly
  \begin{align*}
    v P_{\cdot j} = \sum_i v_i P_{ij} &=
      \frac{m!}{(j-1)!(m-(j-1))!} \left(\frac{1}{2}\right)^m
      +
      \frac{m!}{(j+1)!(m-(j+1))!} \left(\frac{1}{2}\right)^m\\
    &=
      \frac{j m!}{j!(m-j)!(m-(j-1))} \left(\frac{1}{2}\right)^m
      +
      \frac{(m-j)m!}{(j+1)j!(m-j)!} \left(\frac{1}{2}\right)^m\\
  \end{align*}


\item % Question 4
  \begin{enumerate} % Question 4a
    \item
  \end{enumerate}

\end{enumerate}


%% APPPENDIX %%

% \appendix




\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%% SAMPLE CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    %% BIBLIOGRAPHIES %%

        \cite{LabelInSourcesFile}  %Use in text; cites
        \citep{LabelInSourcesFile} %Use in text; cites in parens

        \nocite{LabelInSourceFile} % Includes in refs w/o specific citation
        \bibliographystyle{apalike}  % Or some other style

        % To ditch the ``References'' header
        \begingroup
        \renewcommand{\section}[2]{} 
        \endgroup

        \bibliography{sources} % where sources.bib has all the citation info

    %% SPACING %%

        \vspace{1in}
        \hspace{1in}


    %% INCLUDING PDF PAGE %%

        \includepdf{file.pdf}


    %% INCLUDING CODE %%

        \verbatiminput{file.ext}    
            %---Includes verbatim text from the file
        \texttt{text}	  
            %---Renders text in courier, or code-like, font

        \matlabcode{file.m}	  
            %---Includes Matlab code with colors and line numbers


    %% INCLUDING FIGURES %%

        % Basic Figure with size scaling
            \begin{figure}[h!]
               \centering
               \includegraphics[scale=1]{file.pdf}
            \end{figure}

        % Basic Figure with specific height
            \begin{figure}[h!]
               \centering
               \includegraphics[height=5in, width=5in]{file.pdf}
            \end{figure}

        % Figure with cropping, where the order for trimming is  L, B, R, T
            \begin{figure}
               \centering
               \includegraphics[trim={1cm, 1cm, 1cm, 1cm}, clip]{file.pdf}
            \end{figure}


        % Side by Side figures
            \begin{figure}[h!]
                \centering
                \mbox{\subfigure{
                    \includegraphics[scale=1]{file1.pdf}
                }\quad\subfigure{
                    \includegraphics[scale=1]{file2.pdf} 
                }
                }
            \end{figure}
    

