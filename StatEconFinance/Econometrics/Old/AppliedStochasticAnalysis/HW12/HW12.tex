\documentclass[12pt]{article}
\author{Matthew Cocci}
\title{Homework 12}
\date{\today}
%% Formatting & Spacing %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry} % most detailed page formatting control
\usepackage{fullpage} % Simpler than using the geometry package; std effect
\usepackage{setspace}
%\onehalfspacing
\usepackage{microtype}


%% Header %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{fancyhdr}
%\pagestyle{fancy}
%\lhead{}
%\rhead{}
%\chead{}
%\setlength{\headheight}{15.2pt}
    %---Make the header bigger to avoid overlap

%\renewcommand{\headrulewidth}{0.3pt}
    %---Width of the line

%\setlength{\headsep}{0.2in}
    %---Distance from line to text


%% Mathematics Related %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm} %allows for labeling of theorems
\usepackage{accents}
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{ex}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}

% Below supports left-right alignment in matrices so the negative
% signs don't look bad
\makeatletter
\renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols #1}}
\makeatother


%% Font Choices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
%\usepackage{blindtext}


%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{graphicx}
\usepackage{subfigure}
    %---For plotting multiple figures at once
%\graphicspath{ {Directory/} }
    %---Set a directory for where to look for figures


%% Hyperlinks %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hyperref}
\hypersetup{
    colorlinks,
        %---This colors the links themselves, not boxes
    citecolor=black,
        %---Everything here and below changes link colors
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%% Including Code %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{verbatim}
    %---For including verbatim code from files, no colors

\usepackage{listings}
\usepackage{color}
\definecolor{mygreen}{RGB}{28,172,0}
\definecolor{mylilas}{RGB}{170,55,241}
\newcommand{\matlabcode}[1]{%
    \lstset{language=Matlab,%
        basicstyle=\footnotesize,%
        breaklines=true,%
        morekeywords={matlab2tikz},%
        keywordstyle=\color{blue},%
        morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},%
        identifierstyle=\color{black},%
        stringstyle=\color{mylilas},%
        commentstyle=\color{mygreen},%
        showstringspaces=false,%
            %---Without this there will be a symbol in
            %---the places where there is a space
        numbers=left,%
        numberstyle={\tiny \color{black}},%
            %---Size of the numbers
        numbersep=9pt,%
            %---Defines how far the numbers are from the text
        emph=[1]{for,end,break,switch,case},emphstyle=[1]\color{red},%
            %---Some words to emphasise
    }%
    \lstinputlisting{#1}
}
    %---For including Matlab code from .m file with colors,
    %---line numbering, etc.

%% Bibliographies %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{natbib}
    %---For bibliographies
%\setlength{\bibsep}{3pt} % Set how far apart bibentries are

%% Misc %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{enumitem}
    %---Has to do with enumeration
\usepackage{appendix}
\usepackage{pdfpages}
    %---For including whole pdf pages as a page in doc


%% User Defined %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\nameofcmd}{Text to display}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% BODY %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle

%\tableofcontents


\begin{enumerate}
  \item % Question 1
    \begin{enumerate}
      \item % Question 1a
        First, we want to show that the following two operators are
        equal
        \begin{align*}
          \mathscr{F} = \pi^{1/2} \mathscr{L} \pi^{-1/2}
          \qquad
          \mathscr{G} = \pi^{-1/2} \mathscr{L}^* \pi^{1/2}
        \end{align*}
        where $\mathscr{L}$ and $\mathscr{L}^*$ correspond to
        \begin{align*}
          \mathscr{L}f   &= -\nabla U(x) \nabla f + \Delta f\\
          \mathscr{L}^*f &= \nabla \cdot \left( \nabla Uf + \nabla f\right)
        \end{align*}
        Since these are the operators for the Smoluchowski Equation, we can
        use a result we already saw:
        \begin{align}
          \pi\mathscr{L}g = \mathscr{L}^*(g\pi)
          \label{q1.1}
        \end{align}
        So start with $\mathscr{F}$ and write out
        \begin{align*}
          \mathscr{F}f
          &= \pi^{1/2} \mathscr{L} \pi^{-1/2}f\\
          &= (\pi^{-1/2} \pi) \mathscr{L} \pi^{-1/2}f\\
          \text{Use (\ref{q1.1}) with $g=\pi^{-1/2}f$}\qquad
          &= \pi^{-1/2} (\pi \mathscr{L} \pi^{-1/2}f)\\
          &= \pi^{-1/2} \mathscr{L}^* (\pi^{-1/2}f\pi)\\
          &= \pi^{-1/2} \mathscr{L}^* (\pi^{1/2}f) = \mathscr{G}f
        \end{align*}

      \item % Question 1b
        Next, we want to show that $\mathscr{F}$ is symmetric under the
        usual $L^2$ inner product, i.e.
        \begin{align*}
          \langle \mathscr{F}f, g\rangle
            =\int_{\mathbb{R}^d} (\mathscr{F}f) g \; dx
          &=
            \int_{\mathbb{R}^d} f (\mathscr{F}g) \; dx
            =\langle f, \mathscr{F}g\rangle
        \end{align*}
        To show this, write out
        \begin{align*}
          \langle \mathscr{F}f, g\rangle
            &=\int_{\mathbb{R}^d} (\mathscr{F}f) g \; dx\\
            &=\int_{\mathbb{R}^d} \left( \pi^{1/2} \mathscr{L}( \pi^{-1/2} f)\right) g \; dx\\
            \text{Rearranging} \qquad
            &=\int_{\mathbb{R}^d}  (\pi^{1/2} g) \mathscr{L} \left(\pi^{-1/2} f\right)  \; dx\\
            \text{Since $\mathscr{L}^*$ is adjoint of $\mathscr{L}$} \qquad
            &=\int_{\mathbb{R}^d} \left(\pi^{-1/2} f\right) \mathscr{L^*} (\pi^{1/2} g)   \; dx\\
            \text{Rearranging} \qquad
            &=\int_{\mathbb{R}^d}  f \left(\pi^{-1/2} \mathscr{L^*} (\pi^{1/2} g) \right)  \; dx\\
            &=\int_{\mathbb{R}^d}  f \mathscr{G}g   \; dx\\
            &= \langle f, \mathscr{G}g\rangle\\
            \text{Since $\mathscr{F}=\mathscr{G}$}\qquad
            &= \langle f, \mathscr{F}g \rangle
        \end{align*}
        Therefore $\mathscr{F}$ is symmetric.
    \end{enumerate}

  \item % Question 2
    \begin{enumerate}
      \item % Question 1a
        We want to find the stationary distribution of
        \begin{align*}
          dX_t &= -(X_t - Y_t)dt + \sigma dW_t^{(1)} \\
          dY_t &= -(Y_t - X_t)dt + \sigma dW_t^{(2)}
        \end{align*}
        Let $\mathbf{J}$ represent the probability flux. In this system,
        we can find a solution where the steady state flux is zero, i.e.
        $\mathbf{J}=0$:
        \begin{align*}
          0 = \mathbf{J} &= b\rho - \frac{1}{2}\nabla\cdot(a\rho)\\
          \begin{pmatrix}
            0 \\ 0
          \end{pmatrix}
          &=
          \begin{pmatrix}
            -(x-y) \rho \\
            -(y-x) \rho \\
          \end{pmatrix}
          - \frac{\sigma^2}{2}
          \begin{pmatrix}
            \frac{\partial \rho}{\partial x} \\
            \frac{\partial \rho}{\partial y} \\
          \end{pmatrix}
        \end{align*}
        So we have the following
        \begin{align*}
          -\frac{2}{\sigma^2} (x-y) \rho
          = \frac{\partial \rho}{\partial x}
          = -\frac{\partial \rho}{\partial y}
        \end{align*}
        This suggests the following stationary distribution:
        \begin{align*}
          \rho(x,y)
          &=
          C e^{-\frac{1}{\sigma^2}(x-y)^2}
        \end{align*}
        where $C$ is a constant to normalize the distribution to be 1 on
        the unit square, i.e.
        \begin{align*}
          C &= \int^1_0\int^1_0 e^{-\frac{1}{\sigma^2}(x-y)^2} dx dy\\
        \end{align*}
        By construction, the steady state flux is zero.

      \item % Question 2b
        We want to find the stationary distribution of
        \begin{align*}
          dX_t &= \sin Y_t \; dt + dW_t^{(1)} \\
          dY_t &= \sin X_t \; dt + dW_t^{(2)}
        \end{align*}
        First, we find the stationary distribution $\rho$ by solving the
        Fokker-Plank Equation with $\partial_t \rho=0$:
        \begin{align*}
          0 &=
          - \sin(y) \frac{\partial \rho}{\partial x}
          - \sin(x) \frac{\partial \rho}{\partial y}
          + \frac{1}{2}\frac{\partial^2 \rho}{\partial x^2}
          + \frac{1}{2}\frac{\partial^2 \rho}{\partial y^2}
        \end{align*}
    \end{enumerate}


  \item % Question 3
    We consider Brownian motion on $[0,1]$ with reflecting boundary
    condition at 1 and absorbing at 0, i.e.
    \begin{align*}
      \mathscr{L} &= \frac{1}{2} \frac{\partial^2}{\partial x^2}\\
      0
      &= -\frac{1}{2} \frac{\partial p}{\partial x}
      = \frac{\partial p}{\partial x}
      \qquad \text{at $x=1$}\\
      0 &= p(0,t)
    \end{align*}

    \begin{enumerate}
      \item % Question 3a
        First, the eigenvalues and eigenfunctions of $\mathscr{L}$:
        \begin{align*}
          \lambda f &= \mathscr{L} f\\
          \Leftrightarrow \qquad
          \lambda f &= \frac{1}{2} \frac{d^2 f}{d x^2}\\
          \Rightarrow \qquad
          0 &= \frac{d^2 f}{d x^2} -2\lambda f
        \end{align*}
        This has solutions
        \begin{align*}
          p(x) = c_1 e^{\sqrt{2\lambda} x} + c_2 e^{-\sqrt{2\lambda} x}
        \end{align*}
        Plugging in boundary condition $p(0)=0$,
        \begin{align}
          0 &= A e^{\sqrt{2\lambda} 0} + B e^{-\sqrt{2\lambda} 0} \notag\\
          0 &= A + B \notag \\
          \Rightarrow \qquad
          A &= -B \label{q3a.1}
        \end{align}
        Next, boundary condition $p'(1) = 0$, using the result above
        \begin{align*}
          p(x) &= A (e^{\sqrt{2\lambda} x} - e^{-\sqrt{2\lambda} x}) \\
          p'(x) &= A \sqrt{2\lambda} (e^{\sqrt{2\lambda} x} +  e^{-\sqrt{2\lambda} x}) \\
          \Rightarrow\qquad
          0 &=
          A \sqrt{2\lambda} (e^{\sqrt{2\lambda}} +  e^{-\sqrt{2\lambda}}) \\
        \end{align*}
        As a result
        \begin{align*}
        \end{align*}
    \end{enumerate}

  \item % Question 5
    This question concerns the Rayleigh Process with SDE and generator
    as follows:
    \begin{align*}
      dA_t &= \left(-\gamma A_t + \frac{\mu}{A_t}\right) dt + \sqrt{2\mu} \; dW_t \\
      \mathscr{L} &= \left(-\gamma a + \frac{\mu}{a}\right) \frac{\partial}{\partial a}
        + \mu \frac{\partial^2}{\partial a^2}
    \end{align*}
    \begin{enumerate}
      \item % Question 5a
        To find the stationary distribution, solve for the distribution
        that makes the probability flux zero:
        \begin{align*}
          0 &=
          \left(-\gamma a + \frac{\mu}{a}\right)\rho_s
          - \mu \frac{d \rho_s}{d a}
          \\
          \Leftrightarrow \qquad
          \frac{d \rho_s}{\rho_s}
          &=
          \left(-\frac{\gamma}{\mu} a + \frac{1}{a}\right)da
        \end{align*}
        which gives a stationary distribution of
        \begin{align*}
          \rho_s(a) &= C a e^{-\frac{\gamma}{2\mu}a^2}
        \end{align*}
        To get this to integrate to 1, we need to choose $C =
        \frac{\gamma}{\mu}$, giving
        \begin{align*}
          \rho_s(a) &= \frac{\gamma}{\mu} a e^{-\frac{\gamma}{2\mu}a^2}
        \end{align*}

      \item % Question 5b
        To find the eigenfunctions of the generator, solve
        \begin{align}
          -\lambda \phi_\lambda
          &= \mathscr{L}\phi_\lambda
          =
           \left(-\gamma a + \frac{\mu}{a}\right) \frac{d\phi_\lambda}{da}
            + \mu \frac{d^2\phi_\lambda}{d a^2} \notag \\
          \Leftrightarrow \qquad
          0 &=
            \frac{d^2\phi_\lambda}{da^2} +
           \left(-\frac{\gamma}{\mu} a + \frac{1}{a}\right) \frac{d\phi_\lambda}{da}
            + \frac{\lambda}{\mu} \phi_\lambda
            \label{q5b.1}
        \end{align}
        Next, let choose $b = \frac{ca^2}{4}$ (for some constant $c$
        that will be chosen later), so that
        \begin{align}
          b = \frac{c a^2}{4}
          \qquad
          \frac{db}{da} = \frac{ca}{2}
          \qquad
          \frac{d^2b}{da^2} = \frac{c}{2}
          \label{q5b.2}
        \end{align}
        Then, substitute that into (\ref{q5b.1}), rewrite with $f$ as
        a function $b$, and simplify:
        \begin{align*}
          0 &=
          \left[
            \frac{d^2 \phi_\lambda}{d b^2}\left(\frac{db}{da}\right)^2
            +\frac{d \phi_\lambda}{d b}\left(\frac{d^2b}{da^2}\right)
            \right]+
           \left(
           -\frac{\gamma}{\mu} a + \frac{1}{a}
           \right)
           \frac{d \phi_\lambda}{d b}
           \frac{d b}{d a}
            + \frac{\lambda}{\mu} \phi_\lambda\\
          \text{Using (\ref{q5b.2})}
          \qquad
          &=
          \left[
            \frac{d^2 \phi_\lambda}{d b^2}\left(\frac{ca}{2}\right)^2
            +\frac{d \phi_\lambda}{d b}\left(\frac{c}{2}\right)
            \right]+
           \left(
           -\frac{\gamma}{\mu} a + \frac{1}{a}
           \right)
           \frac{d \phi_\lambda}{d b}
           \frac{ca}{2}
            + \frac{\lambda}{\mu} \phi_\lambda\\
          0&=
            \frac{c^2a^2}{4}\frac{d^2 \phi_\lambda}{d b^2}
            +
           c\left(
           1-\frac{\gamma}{\mu} \frac{a^2}{2}
           \right)
           \frac{d \phi_\lambda}{d b}
            + \frac{\lambda}{\mu} \phi_\lambda\\
          \text{Since $c\neq 0$}\Rightarrow\qquad
          0&=
            \frac{ca^2}{4}\frac{d^2 \phi_\lambda}{d b^2}
            +
           \left(
           1-\frac{\gamma}{\mu} \frac{a^2}{2}
           \right)
           \frac{d \phi_\lambda}{d b}
            + \frac{\lambda}{c\mu} \phi_\lambda
        \end{align*}
        This shows how to choose $c$ (to get this into Laguerre form),
        since we need:
        \begin{align*}
          \frac{ca^2}{4} &= \frac{\gamma}{\mu} \frac{a^2}{2}
          \qquad \Rightarrow\qquad
          c = \frac{2\gamma}{\mu}
        \end{align*}
        Substituting this back in, the differential equation becomes
        \begin{align*}
          0&=
            \left(\frac{\gamma}{2\mu} a^2\right)
            \frac{d^2 \phi_\lambda}{d b^2}
            +
           \left(
           1-\frac{\gamma}{2\mu} a^2
           \right)
           \frac{d \phi_\lambda}{d b}
            + \frac{\lambda}{2\gamma} \phi_\lambda
        \end{align*}
        This is precisely the differential equation that the Laguerre
        polynomials solve, provided $x=\frac{\gamma}{2\mu} a^2$ and
        we scale the eigenvalues so $\lambda_n=2\gamma n$.

        Therefore, the solutions are
        \begin{align*}
          f(x) = \frac{e^x}{n!} \frac{d^n}{dx^n} \left[ e^{-x} x^n\right]
        \end{align*}

    \end{enumerate}

\end{enumerate}

\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% SAMPLE CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    %% BIBLIOGRAPHIES %%

        \cite{LabelInSourcesFile}  %Use in text; cites
        \citep{LabelInSourcesFile} %Use in text; cites in parens

        \nocite{LabelInSourceFile} % Includes in refs w/o specific citation
        \bibliographystyle{apalike}  % Or some other style

        % To ditch the ``References'' header
        \begingroup
        \renewcommand{\section}[2]{}
        \endgroup

        \bibliography{sources} % where sources.bib has all the citation info

    %% SPACING %%

        \vspace{1in}
        \hspace{1in}


    %% INCLUDING PDF PAGE %%

        \includepdf{file.pdf}


    %% INCLUDING CODE %%

        \verbatiminput{file.ext}
            %---Includes verbatim text from the file
        \texttt{text}
            %---Renders text in courier, or code-like, font

        \matlabcode{file.m}
            %---Includes Matlab code with colors and line numbers


    %% INCLUDING FIGURES %%

        % Basic Figure with size scaling
            \begin{figure}[h!]
               \centering
               \includegraphics[scale=1]{file.pdf}
            \end{figure}

        % Basic Figure with specific height
            \begin{figure}[h!]
               \centering
               \includegraphics[height=5in, width=5in]{file.pdf}
            \end{figure}

        % Figure with cropping, where the order for trimming is  L, B, R, T
            \begin{figure}
               \centering
               \includegraphics[trim={1cm, 1cm, 1cm, 1cm}, clip]{file.pdf}
            \end{figure}


        % Side by Side figures
            \begin{figure}[h!]
                \centering
                \mbox{\subfigure{
                    \includegraphics[scale=1]{file1.pdf}
                }\quad\subfigure{
                    \includegraphics[scale=1]{file2.pdf}
                }
                }
            \end{figure}


