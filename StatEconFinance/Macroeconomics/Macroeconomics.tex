\documentclass[12pt]{article}

\author{Matthew D. Cocci}
\title{Macroeconomics}
\date{\today}

%% Formatting & Spacing %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry} % most detailed page formatting control
\usepackage{fullpage} % Simpler than using the geometry package; std effect
\usepackage{setspace}
%\onehalfspacing
\usepackage{microtype}

%% Formatting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage[margin=1in]{geometry}
    %   Adjust the margins with geometry package
%\usepackage{pdflscape}
    %   Allows landscape pages
%\usepackage{layout}
    %   Allows plotting of picture of formatting



%% Header %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{fancyhdr}
%\pagestyle{fancy}
%\lhead{}
%\rhead{}
%\chead{}
%\setlength{\headheight}{15.2pt}
    %   Make the header bigger to avoid overlap

%\fancyhf{}
    %   Erase header settings

%\renewcommand{\headrulewidth}{0.3pt}
    %   Width of the line

%\setlength{\headsep}{0.2in}
    %   Distance from line to text


%% Mathematics Related %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm} %allows for labeling of theorems
%\numberwithin{equation}{section} % Number equations by section
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{ex}[thm]{Example}

\theoremstyle{remark}
\newtheorem*{rmk}{Remark}
\newtheorem*{note}{Note}

% Below supports left-right alignment in matrices so the negative
% signs don't look bad
\makeatletter
\renewcommand*\env@matrix[1][c]{\hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{*\c@MaxMatrixCols #1}}
\makeatother


%% Font Choices %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
%\usepackage{blindtext}
\usepackage{courier}


%% Figures %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing}
\usepackage{graphicx}
\usepackage{subfigure}
    %   For plotting multiple figures at once
%\graphicspath{ {Directory/} }
    %   Set a directory for where to look for figures


%% Hyperlinks %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hyperref}
\hypersetup{%
    colorlinks,
        %   This colors the links themselves, not boxes
    citecolor=black,
        %   Everything here and below changes link colors
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%% Colors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{color}
\definecolor{codegreen}{RGB}{28,172,0}
\definecolor{codelilas}{RGB}{170,55,241}

% David4 color scheme
\definecolor{d4blue}{RGB}{100,191,255}
\definecolor{d4gray}{RGB}{175,175,175}
\definecolor{d4black}{RGB}{85,85,85}
\definecolor{d4orange}{RGB}{255,150,100}

%% Including Code %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{verbatim}
    %   For including verbatim code from files, no colors
\usepackage{listings}
    %   For including code snippets written directly in this doc

\lstdefinestyle{bash}{%
  language=bash,%
  basicstyle=\footnotesize\ttfamily,%
  showstringspaces=false,%
  commentstyle=\color{gray},%
  keywordstyle=\color{blue},%
  xleftmargin=0.25in,%
  xrightmargin=0.25in
}

\lstdefinestyle{matlab}{%
  language=Matlab,%
  basicstyle=\footnotesize\ttfamily,%
  breaklines=true,%
  morekeywords={matlab2tikz},%
  keywordstyle=\color{blue},%
  morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},%
  identifierstyle=\color{black},%
  stringstyle=\color{codelilas},%
  commentstyle=\color{codegreen},%
  showstringspaces=false,%
    %   Without this there will be a symbol in
    %   the places where there is a space
  numbers=left,%
  numberstyle={\tiny \color{black}},%
    %   Size of the numbers
  numbersep=9pt,%
    %   Defines how far the numbers are from the text
  emph=[1]{for,end,break,switch,case},emphstyle=[1]\color{red},%
    %   Some words to emphasise
}

\newcommand{\matlabcode}[1]{%
    \lstset{style=matlab}%
    \lstinputlisting{#1}
}
    %   For including Matlab code from .m file with colors,
    %   line numbering, etc.

%% Bibliographies %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{natbib}
    %---For bibliographies
%\setlength{\bibsep}{3pt} % Set how far apart bibentries are

%% Misc %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{enumitem}
    %   Has to do with enumeration
\usepackage{appendix}
%\usepackage{natbib}
    %   For bibliographies
\usepackage{pdfpages}
    %   For including whole pdf pages as a page in doc


%% User Defined %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\nameofcmd}{Text to display}
\newcommand*{\Chi}{\mbox{\large$\chi$}} %big chi
    %   Bigger Chi

% In math mode, Use this instead of \munderbar, since that changes the
% font from math to regular
\makeatletter
\def\munderbar#1{\underline{\sbox\tw@{$#1$}\dp\tw@\z@\box\tw@}}
\makeatother

% Limits
\newcommand{\limN}{\lim_{N\rightarrow\infty}}
\newcommand{\limn}{\lim_{n\rightarrow\infty}}
\newcommand{\limt}{\lim_{t\rightarrow\infty}}
\newcommand{\limT}{\lim_{T\rightarrow\infty}}
\newcommand{\limhz}{\lim_{h\rightarrow 0}}

% Misc Math
\newcommand{\Prb}{\mathrm{P}}
\newcommand{\ra}{\rightarrow}
\newcommand{\diag}{\text{diag}}
\newcommand{\ch}{\text{ch}}
\newcommand{\dom}{\text{dom}}

% Script
\newcommand{\sF}{\mathscr{F}}
\newcommand{\sB}{\mathscr{B}}
\newcommand{\sL}{\mathscr{L}}
\newcommand{\sM}{\mathscr{M}}
\newcommand{\sT}{\mathscr{T}}
\newcommand{\sA}{\mathscr{A}}

% Mathcal
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calH}{\mathcal{H}}

% Dot over
\newcommand{\dx}{\dot{x}}
\newcommand{\ddx}{\ddot{x}}
\newcommand{\dy}{\dot{y}}
\newcommand{\ddy}{\ddot{y}}

% Derivatives
\newcommand{\dydx}{\frac{dy}{dx}}
\newcommand{\pypx}{\frac{\partial y}{\partial x}}

% Blackboard
\newcommand{\R}{\mathbb{R}}
\newcommand{\Rn}{\mathbb{R}^n}
\newcommand{\Rk}{\mathbb{R}^n}
\newcommand{\Rnn}{\mathbb{R}^{n\times n}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Cn}{\mathbb{C}^n}
\newcommand{\Cnn}{\mathbb{C}^{n\times n}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\N}{\mathbb{N}}

\DeclareMathOperator*{\argmin}{arg\;min}
\DeclareMathOperator*{\argmax}{arg\;max}
\newenvironment{rcases}
  {\left.\begin{aligned}}
  {\end{aligned}\right\rbrace}

% Various probability and statistics commands
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Corr}{\operatorname{Corr}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\asto}{\xrightarrow{a.s.}}
\newcommand{\pto}{\xrightarrow{p}}
\newcommand{\msto}{\xrightarrow{m.s.}}
\newcommand{\dto}{\xrightarrow{d}}
\newcommand{\Lpto}{\xrightarrow{L_p}}
\newcommand{\plim}{\text{plim}_{n\rightarrow\infty}}

% Redefine real and imaginary from fraktur to plain text
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}

% Shorter sums: ``Sum from X to Y''
% - sumXY  is equivalent to \sum^Y_{X=1}
% - sumXYz is equivalent to \sum^Y_{X=0}
\newcommand{\sumnN}{\sum^N_{n=1}}
\newcommand{\sumin}{\sum^n_{i=1}}
\newcommand{\sumkn}{\sum^n_{k=1}}
\newcommand{\sumtT}{\sum^T_{t=1}}
\newcommand{\sumninf}{\sum^\infty_{n=1}}
\newcommand{\sumtinf}{\sum^\infty_{t=1}}
\newcommand{\sumnNz}{\sum^N_{n=0}}
\newcommand{\suminz}{\sum^n_{i=0}}
\newcommand{\sumknz}{\sum^n_{k=0}}
\newcommand{\sumtTz}{\sum^T_{t=0}}
\newcommand{\sumninfz}{\sum^\infty_{n=0}}
\newcommand{\sumtinfz}{\sum^\infty_{t=0}}

\newcommand{\tinf}{^\infty_{t=1}}
\newcommand{\tinfz}{^\infty_{t=0}}

% Shorter integrals: ``Integral from X to Y''
% - intXY is equivalent to \int^Y_X
\newcommand{\intab}{\int_a^b}
\newcommand{\intzN}{\int_0^N}
\newcommand{\intzo}{\int_0^1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% BODY %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle

\tableofcontents

\clearpage

\section{Building Blocks}

\subsection{Utility Functions}


\subsection{Risk Aversion and Important Elasticities}

\begin{defn}(Absolute Risk Aversion)
Given twice-differentiable utility function $u$,
\emph{absolute risk aversion} is defined
\begin{align*}
  A(c) = -\frac{u''(c)}{u'(c)}
\end{align*}
\end{defn}

\begin{defn}(Relative Risk Aversion)
Given twice-differentiable utility function $u$,
\emph{relative risk aversion} is defined
\begin{align*}
  R(c) = cA(c) = -\frac{c u''(c)}{u'(c)}
\end{align*}
\end{defn}

\begin{defn}(Intertemporal Elasticity of Substitution)
Given differentiable utility function $u$,
the \emph{intertemporal elasticity of substitution} is defined
\begin{align*}
  \text{IES}
  = -\frac{\partial \ln(c_{t+1}/c_t)}{\partial r}
  = -\frac{\partial \ln(c_{t+1}/c_t)}{%
    \partial \ln(u'(c_{t+1})/u'(c_t))}
\end{align*}
The IES answers the question ``How much to I change the (log-normalized)
slope of my consumption profile $\{c_t,c_{t+1}\}$---i.e.\ my consumption
growth---in response to a change in the interest rate?''
High IES means that the the consumer will change her consumption
dramatically given small changes in the interest rate---high elasticity,
comfortable substituting across time.
Low IES corresponds to a strong smoothing motive. The consumer is
\emph{not} very responsive to changes in the interest rate, so the
consumption profile over time will be flatter.
\end{defn}
\begin{rmk}
Why are these two IES equations equivalent?
It comes from the savings problem solved by a utility maximizing
household. Consider the two-period case for simplicity (though it also
holds in the infinite horizon problem with separable period utility):
\begin{align*}
  \max_{a_t} \; &
  u\big(
  \underbrace{y_t-a_t}_{c_t}
  \big)
  + \beta
  u\big(
  \underbrace{y_{t+1}+Ra_t}_{c_{t+1}}
  \big)
\end{align*}
where $y_t$ is exogenously given income at time $t$ and $a_t$ is the amount
of assets bought at time $t$, which mature at time $t+1$ and have gross
return $R$. It has first order condition
\begin{align*}
  %u'(c_t) = \beta R u'(c_{t+1})
  %\quad\iff\quad
  R = \frac{u'(c_t)}{\beta u'(c_{t+1})}
  \quad\iff\quad
  r &= -\ln \left(\frac{u'(c_{t+1})}{u'(c_t)}\right) -\ln\beta
\end{align*}
where $r=\ln R$. Now this equation must always hold for any consumption
savings problem with time-separable utility. Moreover, $\beta$ is just a
fixed parameter; it does not change. Therefore, if we change $r$, the
agent must change his consumption profile $\{c_t,c_{t+1}\}$ to change
the log-ratio of marginal utilities $\ln\big(u'(c_{t+1})/u'(c_t)\big)$
so that this equation is true. Hence,
$\partial r = \partial \ln(u'(c_{t+1})/u'(c_t))$, which is why the two
IES expressions are equivalent.
\end{rmk}

\begin{defn}(Frisch Elasticity of Labor Supply)

\end{defn}



\clearpage
\subsection{Power or CRRA Utility}

\begin{defn}(Power Utility or CRRA)
We define the period power utility function as
\begin{align*}
  u(c) &= \frac{c^{1-\sigma}-1}{1-\sigma}
  \qquad \sigma\geq 0
  \\
  u'(c) &= c^{-\sigma} \\
  u''(c) &= -\sigma c^{-\sigma-1}
\end{align*}
where $\sigma\geq 0$ controls the curvature of the utility function.
For $\sigma=0$, utility is linear.
It also has the feature that
\begin{align*}
  \lim_{\sigma\ra 1}
  \frac{c^{1-\sigma}-1}{1-\sigma}
  &= \ln(c)
\end{align*}
which is why we have $-1$ in the numerator (so we can apply L'Hospital),
though it's just a constant that doesn't really affect $u$.
\\
\\
It exhibits constant relative risk aversion
\begin{align*}
  R(c) &=
  -\frac{c u''(c)}{u'(c)}
  = -\frac{c (-\sigma c^{-\sigma-1})}{c^{-\sigma}}
  = \sigma
\end{align*}
The IES is also tied to the coefficient of relative risk aversion, as
$\sigma$ is the inverse IES:
\begin{align*}
  IES
  = \frac{1}{\sigma}
\end{align*}
So if $\sigma$ is large, the IES is very low: the agent does not like
variable consumption. For small $\sigma$, the agent cares less about
variability in consumption, is willing to substitute across time, and
exhibits a large intertemporal elasticity of substitution.
\end{defn}

\begin{prop}
The Power Utility Function characterizes the class of all utility
functions with Constant Relative Risk Aversion.
\end{prop}
\begin{proof}
To have constant relative risk aversion, we need
\begin{align*}
  -\frac{cu''(c)}{u'(c)} = k
  \quad\iff\quad
  cu''(c) + ku'(c) = 0
\end{align*}
for some constant $k$. We want to solve for $u$ that satisfies this. To
do so, define $v(c)=u'(c)$, substitute, and solve:
\begin{align*}
  v'(c) + \frac{k}{c}v(c) &= 0
\end{align*}
We will use an integrating factor
\begin{align*}
  e^{\int \frac{k}{c} \; dc}=e^{k\ln c} = (e^{\ln c})k = c^k
\end{align*}
Therefore, multiply through and solve
\begin{align*}
  c^k v'(c) + kc^{k-1}v(c) &= 0 \\
  \left(c^k v(c)\right)' &= 0 \\
  c^k v(c) &= 1 \\
  \implies \quad v(c) = u'(c) &= c^{-k} \\
  \implies \quad u(c) &= c^{1-k}
\end{align*}
where I left out constants in lots of spots because scaling by a
constant or adding constants doesn't matter for utility. But otherwise,
you see that this is exactly the form of power utility where $k=\sigma$.
\end{proof}

\begin{prop}
Given a balanced growth path for consumption such that
$c_{t+1} = (1+g) c_{t}$,
Power Utility is the only functional form where the ratio of marginal
utilty between periods satisfies
\begin{align*}
  \frac{u'(c_t)}{u'((1+g)c_t)} = k
\end{align*}
for some constant $k$ and all $t$.
\end{prop}
\begin{rmk}
This is often super useful, because some balanced growth path results
require that the ratio of marginal utility between periods is constant.
This tells us that we have to use this form of utility.
\end{rmk}
\begin{proof}
We want to prove that Power Utility is the \emph{only} functional form
of utility displaying this property. Start with what we need to hold:
\begin{align}
  \frac{u'(c)}{u'((1+g)c)} = k
  \quad\iff\quad
  u'(c) = ku'((1+g)c)
  \label{kexp}
\end{align}
Differentiate both sides:
\begin{align*}
  u''(c) &= ku''((1+g)c)(1+g)
\end{align*}
Sub in the expression for $k$ from Equation~\ref{kexp}:
\begin{align*}
  u''(c) &=
  \frac{u'(c)}{u'((1+g)c)} u''((1+g)c)(1+g) \\
  \iff \qquad
  \frac{u''(c)}{u'(c)} &=
  \frac{u''((1+g)c)(1+g)}{u'((1+g)c)}
\end{align*}
Mulitply through by $-c$
\begin{align*}
  -\frac{u''(c)c}{u'(c)} &=
  -\frac{u''((1+g)c)(1+g)c}{u'((1+g)c)}
\end{align*}
But each ratio is relative risk aversion at either $c_t$ or $c_{t+1}$.
So this says that relative risk aversion for all $t=1,2,\ldots$ even
though consumption $c_t$ is growing at rate of $g$. In other words,
relative risk aversion is constant no matter the level of $c_t$. But
power utility is the only class of utility functions satisfying this
property.
\end{proof}

\clearpage
\subsection{Static Resource Allocation Problems}


\clearpage
\subsection{Static Model with Variety, Fixed $N$}

\subsubsection{Preferences, Technology, Endowments}

We define the usual trifecta of primitives for a macro problem:
\begin{enumerate}
  \item \emph{Preferences}:
    Given mass of goods $N$ and the preference parameter $\rho\in(0,1)$,
    define utility of consumption of a continuum of goods, captured by
    function $c:[0,N]\ra \R$, as
    \begin{align*}
      U(c) &=
      u\left(
      \left[
      \int_0^N c(i)^\rho \; di
      \right]^{1/\rho}
      \right)
    \end{align*}
    where $c(i)$ is consumption of the $i$th good and $u$ is some
    standard utility function and $u$ is some standard utility function
    defined for one good. In this way, big $U$ aggregates the utility of
    consuming $c(i)$ units of each $i$th good.  The above has limiting
    cases
    \begin{itemize}
      \item $\rho\ra 0$: Cobb-Douglas
      \item $\rho\ra 1$: Perfect substitutes
    \end{itemize}

  \item \emph{Technology}:
    There is a variety of goods to consume, each of which is produced by
    a different firm, so we need to define the production function for
    each firm:
    \begin{align*}
      y(i) = A h(i)
    \end{align*}
    where $y(i)$ is output of the $i$th good from the $i$th firm and
    $h(i)$ is labor used to produce it. All of the firms have identical
    technology in the sense that the same amount of labor produces the
    same output of output for any good. We ignore capital for now.

  \item \emph{Endowments}: Each household has one unit of labor to
    supply to the firms.
\end{enumerate}

\clearpage
\subsubsection{Social Planner's Problem}

We have Social Planner's problem
\begin{align*}
  \max_{c(i), h(i)\geq 0}
    & \; u\left(
      \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
    \right)\\
  \text{s.t} & \;
  \intzN h(i) \; di = 1
  \qquad\qquad
  \text{(Labor Market Clearing)} \\
  &\; c(i) = y(i) = Ah(i)
  \qquad
  \text{(Goods Market Clearing)}
\end{align*}
Use Goods Market Clearing to eliminate $c(i)$ from the problem:
\begin{align*}
  \max_{h(i)\geq 0}
    & \; u\left(
    \left[ \int_0^N (Ah(i))^\rho \; di \right]^{1/\rho}
    \right)\\
  \text{s.t} & \;
  \intzN h(i) \; di = 1
\end{align*}
Differentiate with respect to $h(i)$ and this gives FOC:
\begin{align*}
  u'\left( \left[ \int_0^N (Ah(i))^\rho \; di \right]^{1/\rho} \right)
  \cdot
  \frac{1}{\rho}\left[ \int_0^N (Ah(i))^\rho \; di \right]^{1/\rho-1}
  \cdot
  \rho A^\rho h(i)^{\rho-1}
  = \lambda
\end{align*}
Dividing the FOC for good $i$ by the FOC for good $j$, we get
\begin{align*}
  \left(
  \frac{h(i)}{h(j)}
  \right)^{\rho-1}
  = 1
  \quad&\implies\quad
  h(i) = h(j)
  \qquad \forall i,j \in[0,N] \\
  &\implies\quad
  h(i) = \frac{1}{N}
\end{align*}
Hence, in equilibrium, labor is split up equally among the firms:
$h^*(i)=\frac{1}{N}$. As a result of goods market clearing, consumption
will be split evenly as well and will equal
\begin{align*}
  c^*(i) = \frac{A}{N}
\end{align*}
This will leady to totaly utility at the optimum of
\begin{align*}
  u\left( \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho} \right)
  =
  u\left( \left[ \int_0^N
      \left[ \frac{A}{N} \right]^\rho \; di
    \right]^{1/\rho} \right)
  =
  u\left( A N^{\frac{1}{\rho}-1}\right)
\end{align*}
Hence, since $\rho\in(0,1)$, utility is \emph{increasing} in $N$.
There's a love of variety in the model
because marginal utility at $c(i)=0$ is infinite for any $i$.

\clearpage
\subsubsection{Arrow-Debreu Competetive Equilibrium}

We now characterize an ADCE in an economy with variety, which will be a list
$c^*(i)$ consumption of each good, $h^*$ total labor supply, $h^*(i)$
labor supply to each firm, and $p^*(i)$ price of each good
satisfying the conditions below.

We leave out wages which are normalized to one. We could do this because
equilibrium wages at each firm must be identical, otherwise each agent
would just work for the highest paying firm. They get no utility from
working for a \emph{particular} firm (just the cash money they get to
buy consumption goods); therefore, they would all just work for the one
paying the highest wages. For each firm in fact to produce in
equilibrium, wages must necessarily be equal, so we can just normalize
wages to one and put prices $p(i)$ in terms of wages. Therefore, $h$
units of labor gets a worker $h$ units of purchasing power to buy
consumption at prices $p(i)$ for $i\in[0,N]$.
\begin{enumerate}
  \item \emph{Household Optimization}: Taking prices $p^*(i)$ as given,
    consumption $c^*(i)$, and total labor supply $h^*$ solve
    \begin{align*}
      \max_{c(i), h}
        & \; u\left(
          \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
        \right)\\
      \text{s.t} & \;
        \intzN p^*(i) c(i) \; di= h \\
      &\; h\in[0,1]
      \qquad c(i) \geq 0
    \end{align*}
    Again, the household is not optimizing over $h(i)$, just total labor
    $h$. They don't care \emph{which} firm they work for. They just care
    amount the total level of labor $h$ they supply since that's how
    they earn money to buy the consumption that they \emph{do} care
    about.

  \item \emph{Firm Optimization}: With each firm taking prices $p^*(i)$
    as given, $h^*(i)$ solves the profit maximization problem:
    \begin{align*}
      h^*(i)
      &=
      \max_{h(i)\geq 0}
      p^*(i) Ah(i) - h(i)
    \end{align*}
    For now, we stick with this competetive-equilibrium price-taking
    assumption. The firms are not exploiting the consumer's desire for
    variety as they will in the next two subsections where the firms are
    monopolistic.

  \item \emph{Market Clearing}: All of the labor provided to the
    different firms must aggregate to the total amount $h$ of labor
    provided, and everything produced must be consumed:
    \begin{align*}
       h^* &= \intzN h^*(i) \; di \\
       c^*(i) &= Ah^*(i)
    \end{align*}
\end{enumerate}
\clearpage
We do the usual things
\begin{enumerate}
  \item \emph{Household FOCs}: First with respect to consumption of the
    $i$th good $c(i)$:
    \begin{align*}
      u'\left(
        \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
      \right)
      \frac{1}{\rho}
      \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho-1}
      \rho c(i)^{\rho-1}
      = \lambda p^*(i)
    \end{align*}
    Dividing the FOC for $c(i)$ by the FOC for $c(j)$:
    \begin{align}
      \left(
      \frac{c(i)}{c(j)}
      \right)^{\rho-1}
      =
      \frac{p^*(i)}{p^*(j)}
      \label{hhfoc-variety}
    \end{align}

  \item \emph{Firm}: It must be the case that profits are zero,
    otherwise the firm would just make infinite profits. Therefore, we
    need
    \begin{align*}
      p^*(i) = \frac{1}{A}
      \qquad \forall i
    \end{align*}

  \item \emph{Market Clearing}: Since prices are all the same at
    $\frac{1}{A}$, Equation~\ref{hhfoc-variety} tells us that
    consumption of all goods must be equal since the prices are equal.
    Therefore, by market clearing, labor must be distributed equally
    among the firms, i.e. $h(i) = \frac{1}{N}$.
\end{enumerate}
Note that the firms are price takers in this market. They're not really
exploiting consumer's desire for variety to make more cash money.  And
since they're just price takers (so that there are no distortions in
this market), the outcome is exactly the same as the Social Planner's
problem---consumption and labor is divided equally among all firms. But
that's not very interesting. We want to see what happens when firms are
price-\emph{setters}, not price-takers.

So in the next two subsections, we dispense with the ``firms as price
takers'' assumption to define the \emph{monopolistic} competetive
equilibrium. First, in the next subsection, we derive the demand
function. Then, in the second next subsection, we define the
monopolistic competetive equilibrium.

\clearpage
\subsubsection{Monopolistic Price Setting and Demand}

Before defining a monopolistic competetive equilibrium, we need to
figure out optimal price setting (or equivalently, the optimal
production decision) chosen by the firm. This is done in steps:
\begin{enumerate}
  \item First, firm $i$ puts itself in the shoes of the consumer,
    solving the consumer's problem to get demand function $c(i)$ in
    terms of income $I$ and price $p(i)$, both of which the consumer
    takes as given when deciding its consumption allocation.

    So again, the consumer makes a consumption decision $c(i)$ given
    prices $p(i)$ and income/wealth $I$, i.e.\ she solves the household
    utility maximization problem
    \begin{align*}
      \max_{c(i) \geq 0}
        & \; u\left(
          \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
        \right)\\
      \text{s.t} & \;
        \intzN p(i) c(i) \; di \leq I
    \end{align*}
    The first order condition for $c(i)$ gives
    \begin{align*}
      u'\left(
        \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
      \right)
      \frac{1}{\rho}
      \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho-1}
      \rho c(i)^{\rho-1}
      = \lambda p(i)
    \end{align*}
    Dividing the FOC for $c(i)$ by the FOC for $c(j)$:
    \begin{align}
      \left(
      \frac{c(i)}{c(j)}
      \right)^{\rho-1}
      =
      \frac{p(i)}{p(j)}
      &\quad \iff \quad
      c(i)
      =
      c(j)
      \left(
      \frac{p(i)}{p(j)}
      \right)^{\frac{1}{\rho-1}}
      \label{cidemand}
    \end{align}
    Equation~\ref{cidemand} summarizes demand for the $i$th good (for
    any $i\in[0,N]$) as a function of both demand for some fixed
    reference good $j$ and the price ratio between $i$ and $j$.

    Since utility is increasing in consumption, Walras' Law tells us that
    the buget constraint will hold with equality, so we can substitute the
    above expression for $c(i)$ into the budget equation and simplify:
    \begin{align*}
      I &= \intzN p(i) c(i) \; di
      = \intzN p(i)
        c(j)
        \left(
        \frac{p(i)}{p(j)}
        \right)^{\frac{1}{\rho-1}} \notag
        \; di
      %\\
      %&=
        %\frac{c(j)}{p(j)^{\frac{1}{\rho-1}}}
        %\intzN p(i)
        %p(i)^{\frac{1}{\rho-1}} \notag
        %\; di \\
      %\implies\quad
      %I
      %&=
      =
        \frac{c(j)}{p(j)^{\frac{1}{\rho-1}}}
        \intzN
        p(i)^{\frac{\rho}{\rho-1}} \notag
        \; di
    \end{align*}
    Therefore, we can summarize demand for good $j$ as
    \begin{align*}
      c(j)
      =
      p(j)^{\frac{1}{\rho-1}}
      \cdot
      \frac{I}{\intzN p(i)^{\frac{\rho}{\rho-1}} \notag \; di}
    \end{align*}
    And since our choice of reference good was arbitrary, this holds for any
    $j$. Notice that this is extremely tractable since the fraction is a
    constant from the perspective of firm $j$. So we have demand for good
    $j$ written quite simply as
    \begin{align*}
      c(j) = B \cdot p(j)^{\frac{1}{\rho-1}}
      \qquad\text{where} \quad B=
      \frac{I}{\intzN p(i)^{\frac{\rho}{\rho-1}} \notag \; di}
    \end{align*}

  \item Next, firm $i$ uses the demand function $c(i)$ and market
    clearing in the output market to choose $p(i)$ that maximizes
    profits.

    So we return to the firm's problem. Taking wages (normalized to one)
    as given, its profit maximizing decision involves setting prices,
    choosing output, and choosing labor to hire
    \begin{align*}
      \max_{p(i), \,h(i), \,y(i)} \; &p(i) y(i) - h(i)
    \end{align*}
    But by market clearing $c(i)=y(i)$, technology $y(i)=Ah(i)$, and
    demand $c(i)=B \cdot p(i)^{\frac{1}{\rho-1}}$ from above, the
    maximization problem reduces to
    \begin{align*}
      \max_{p(i)} \; &p(i) c(i) - \frac{c(i)}{A} \\
      \max_{p(i)}
      \; &p(i) \left[B p(i)^{\frac{1}{\rho-1}}\right]
        - \frac{1}{A} \left[B p(i)^{\frac{1}{\rho-1}}\right] \\
      \max_{p(i)}
      \; & B p(i)^{\frac{\rho}{\rho-1}}
        - \frac{B}{A} \left[p(i)^{\frac{1}{\rho-1}}\right]
    \end{align*}
    Differentiating with respect to $p(i)$, this leads to FOC
    \begin{align*}
      0&=
      B {\frac{\rho}{\rho-1}} p(i)^{\frac{1}{\rho-1}}
        - \frac{B}{A} \frac{1}{\rho-1}p(i)^{\frac{1}{\rho-1}-1} \\
      \Rightarrow\quad
      p(i) &= \frac{1}{\rho A}
    \end{align*}
    Note that this has a very nice form, as $\frac{1}{A}$ is the
    marginal cost of production, while $\frac{1}{\rho}$ is refers to how
    willing households are to substitute across varieties.


  \item Prices $p(i)$ directly map to a production/consumption amount
    $c(i)$ in equilibrium.

    Recall demand:
    \begin{align*}
      c(i)
      &= B\cdot p(i)^{\frac{1}{\rho-1}}
      = B\cdot \left(\frac{1}{\rho A}\right)^{\frac{1}{\rho-1}}
    \end{align*}
    where we have
    \begin{align*}
      B
      = \frac{I}{\intzN p(i)^{\frac{\rho}{\rho-1}}di}
      =
      \frac{I}{\intzN \left(\frac{1}{\rho A}\right)^{\frac{\rho}{\rho-1}}di}
      =
      \frac{I}{N\left(\frac{1}{\rho A}\right)^{\frac{\rho}{\rho-1}}}
    \end{align*}
    Substiting this expression for $B$ back into the expression for
    $c(i)$, we get
    \begin{align*}
      c(i)
      &= \left(\frac{1}{\rho A}\right)^{\frac{1}{\rho-1}}
      \left(
      \frac{I}{N\left(\frac{1}{\rho A}\right)^{\frac{\rho}{\rho-1}}}
      \right) \\
      \implies\quad
      c(i)
      &= \frac{I\rho A}{N}
    \end{align*}
\end{enumerate}


\clearpage
\subsubsection{Monopolistic Competitive Equilibrium}

We now characterize an MCE (monopolistic competitive equilibrium) in an
economy with variety, which a list $c^*(i)$ consumption of
each good, $h^*$ total labor supply, $h^*(i)$ labor supply to each firm,
$d^*_i(p)$ demand for good $i$ given price $p$ (holding all other prices
and profits constant), $p^*(i)$ prices for each good (wages left out
because normalized to one), and $\pi^*(i)$ profits that satisfy the
following conditions:
\begin{enumerate}
  \item \emph{Household Optimization}: Taking prices $p^*(i)$ and
    profits $\pi^*(i)$ as given, consumption $c^*(i)$, and total labor
    supply $h^*$ solve
    \begin{align*}
      (c^*(i), h^*)
      = \max_{c(i), h}
        & \; u\left(
          \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
        \right)\\
      \text{s.t} & \;
        \intzN p^*(i) c(i) \; di \leq h
          + \intzN \pi^*(i) \; di \\
      &\; h\in[0,1]
      \qquad c(i) \geq 0
    \end{align*}
    while also $d^*_i(p)$ is the optimal choice for good $i$ as a
    function of price, holding all other prices and profits constant.

  \item \emph{Firm Optimization}: With each firm taking \emph{demand}
    (not prices this time) $d_i^*(p)$ as given, $p^*(i)$ and $h^*(i)$
    solve the profit maximization problem:
    \begin{align*}
      \max_{p(i),h(i)}
      &\;
      p(i) Ah(i) - h(i) \\
      \text{s.t.} \;
      & \; Ah(i) = d_i^*[p(i)] \\
      & \; h(i) \geq 0\\
      & \; \pi^*(i) = p^*(i) Ah^*(i) - h^*(i)
    \end{align*}

  \item \emph{Market Clearing}: All of the labor provided to the
    different firms must aggregate to the amount of total labor
    provided, and everything produced must be consumed:
    \begin{align*}
       h^* &= \intzN h^*(i) \; di \\
       c^*(i) &= Ah^*(i)
    \end{align*}
\end{enumerate}


\clearpage
\subsection{Static Model with Variety, Endogenous $N$}

As we saw in the fixed $N$ subsection, households love variety, so $N$
is substantive. But so far, we've just taken it as given. Where does it
come from? Since it is important, we probably want to endogenize it.
But notice that since consumers love variety, the social planner would
just send $N\ra \infty$ if $N$ were a totally free variable. Therefore,
we want to introduce costs to producing/supporting more variety to make
sure this problem is well-defined.

\subsubsection{Preferences, Technology, Endowments}

Things look similar to the case of fixed $N$, except $N$ is now chosen
in equilibrium and labor has two uses: (1) setting $N$, the mass of
varieties and (2) producing output of the varieties. Therefore, the only
part that really changes is the technology portion:
\begin{enumerate}
  \item \emph{Preferences}:
    As before, given preference parameter $\rho\in(0,1)$, we define
    utility of consumption of a continuum of goods as
    \begin{align*}
      U(c) &=
      u\left(
      \left[
      \int_0^N c(i)^\rho \; di
      \right]^{1/\rho}
      \right)
    \end{align*}

  \item \emph{Technology}:
    $N$ represents the mass of varieties of goods that can be consumed.
    We let $\bar{h}$ represent the labor cost of producing/supporting
    one unit of variety, so that supporting a mass of $N$ units of
    variety costs a total of $N\bar{h}$ units of labor supplied by the
    household.

    Firms then employ the remaining $1-N\bar{h}$ units of labor to
    produce each of the existing varieties in $[0,N]$. Each variety is
    produced by a different firm according to production function
    \begin{align*}
      y(i) = A h(i)
    \end{align*}
    where $y(i)$ is output of the $i$th good from firm $i$ and $h(i)$ is
    labor used to produce it.

    Just a quick word about the choice of $N$.
    In the case of the social planner, it is chosen by making the
    optimal tradeoff between
    \begin{enumerate}
      \item Expanding the mass of varieties to $[0,N]$ at cost
        $N\bar{h}$
      \item Production (which becomes consumption) of those varieties in
        $[0,N]$ with the remaining $1-N\bar{h}$ units of labor
    \end{enumerate}
    On the other hand, in a symmetric MCE, $N$ is determined by by
    entry. It costs $\bar{h}$ per unit of variety, which is paid for by
    the firms' profits. Since monopolistically competetive profits are
    zero, they can cover and exactly balance out the costs of entry.

  \item \emph{Endowments}: Each household has one unit of labor to
    supply to the firms.
\end{enumerate}

\clearpage
\subsubsection{Social Planner's Problem}

The social planner maximizes utility by choosing $c(i)$, $h(i)$, and
$N$:
\begin{align*}
  \max_{c(i),h(i),N\geq 0}
    & \; u\left(
      \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
    \right)
  \\
  \text{s.t.} & \;
  \intzN h(i) \; di = 1 - N\bar{h}
  \qquad
  \text{(Labor Market Clearing)} \\
  &\; c(i) = Ah(i)
  \qquad\qquad\qquad
  \text{(Goods Market Clearing)}
\end{align*}
where ``Labor Market Clearing'' says that  $\intzN h(i)\; di$---the
total amount of labor used in producing $y(i)$ for $i\in[0,N]$---must
equal $1-N\bar{h}$---the total labor left over for production after
spending $N\bar{h}$ units of labor on producing exactly that mass $N$ of
variety in the first place.
\\
\\
Start by eliminating $c(i)$ from the problem
\begin{align*}
  \max_{h(i),N}
    & \; u\left(
      \left[ \int_0^N \left(Ah(i)\right)^\rho \; di \right]^{1/\rho}
    \right)
  \\
  \text{s.t} & \;
  \intzN h(i) \; di = 1 - N\bar{h}
\end{align*}
Notice that the labor supply problem hasn't really changed relative to
the fixed $N$ case. If we get the FOCs with respect to $h(i)$, it will
still be the case that the household should allocate labor evenly among
the firms to consume evenly across varieties. Only now, there are only
$1-N\bar{h}$ units of labor to allocate towards producing the varieties
(by the labor market clearing constraint) so that
$h(i)=\frac{1-N\bar{h}}{N}$. Hence, we can sub in to simplify
\begin{align*}
  \max_{N\geq 0}
    & \; u\left(
      \left[ \int_0^N
      \left(A\left(\frac{1-N\bar{h}}{N}\right)\right)^\rho \; di
    \right]^{1/\rho}
    \right) \\
  \Leftrightarrow\quad
  \max_{N\geq 0}
    & \; u\left(
      A(1-N\bar{h})
      N^{\frac{1}{\rho}-1}
    \right)
\end{align*}
But since $u$ is an increasing function, we can just maximize
\begin{align*}
  \max_{N\geq 0}
    & \;
      A(1-N\bar{h})
      N^{\frac{1}{\rho}-1}
\end{align*}
which has FOCs
\begin{align*}
  A\bar{h} N^{\frac{1}{\rho}-1}
  &=
  \left(\frac{1}{\rho}-1\right)
  A(1-N\bar{h}) N^{\frac{1}{\rho}-2} \\
  \Rightarrow\quad
  N &= \frac{1-\rho}{\bar{h}}
\end{align*}
So as $\rho\ra 1$ and the consumer views the goods more as perfect
substitutes, the social planner opts for fewer firms (and vice versa).
Moreover, as the cost $\bar{h}$ of creating new firms decreases, the
social planner opts for more firms.


\clearpage
\subsubsection{Symmetric MCE with Entry}

The goal here is to take everything the same, but let $N$ be endogenous.
We know what the equilibrium looks like for fixed $N$. It will just be a
matter of letting $N$ be a free parameter that adjusts until profits
from entry are zero.

So we now characterize a symmetric MCE in an economy with entry, which a
list
$c^*(i)$ consumption of each good,
$h^*$ total labor supply,
$h^{f*}$ labor for each producing firm,
%$h^*(i)$ labor supply to each firm,
$d^*(p)$ demand for each good $i$ given price $p$ (holding all other
prices and profits constant),
$p^*$ price for each good,
and $N^*>0$ mass of firms that satisfy the following conditions:
\begin{enumerate}
  \item \emph{Household Optimization}: Taking prices $p^*$ as given,
    consumption $c^*(i)$ and total labor supply $h^*$ solve
    \begin{align*}
      \max_{c(i), h}
        & \; u\left(
          \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
        \right)\\
      \text{s.t} & \;\;
         p^*\intzN c(i) \; di \leq h \\
      &\; h\in[0,1]
      \qquad c(i) \geq 0
    \end{align*}
    while also $d^*(p)$ is the optimal choice each good as a function of
    price, holding all other prices and profits constant.

  \item \emph{Firm Optimization}: With each firm taking \emph{demand}
    (again, not prices this time) $d^*(p)$ as given, $p^*$ and
    $h^{f*}$ solve the profit maximization problem:
    \begin{align*}
      \max_{p,h(i)} &\;\
      p\cdot Ah^f - h^f \\
      \text{s.t.} \;
      & \; Ah^f = d^*[p] \\
      & \; h^f \geq 0
    \end{align*}
    and, the free entry condition, which states that profits from entry
    equal fixed costs of entry:
    \begin{align*}
      p^*\cdot Ah^{f*} - h^{f*} = \bar{h}
    \end{align*}

  \item \emph{Market Clearing}: All of the labor employed by the
    different firms in production of output and production of variety
    must equal the total labor supply:
    \begin{align*}
        N^*(h^{*f}+\bar{h}) &= h^*
    \end{align*}
    and and everything produced must be consumed
    \begin{align*}
        c^*(i) &= Ah^{*f} \qquad \forall i
    \end{align*}
\end{enumerate}
To solve, we can use previous results. In particular, we know that labor
will be provided evenly to all producing firms, i.e.
$h^{f*}=\frac{1-N^*\bar{h}}{N^*}$ for each producing firm, where $N^*$
is the equilibrium value that we want to solve for. We also know that
prices will be $p^*=\frac{1}{\rho}\cdot\frac{1}{A}$ for each of the
goods produced. So plug these things into the zero-profit free entry
condition to compute $N^*$:
\begin{align*}
  p^*\cdot Ah^{f*} - h^{f*} &= \bar{h} \\
  \left(\frac{1}{\rho}\cdot\frac{1}{A}\right)\cdot
  \left[A \left(\frac{1-N^*\bar{h}}{N^*}\right)\right]
  - \left(\frac{1-N^*\bar{h}}{N^*}\right)
  &= \bar{h}
\end{align*}
This implies that
\begin{align*}
  N^* &= \frac{1-\rho}{\bar{h}}
\end{align*}

\clearpage
\section{Neoclassical Model}

\subsection{The Economy}
We set up the model to capture two basic tradeoffs for the household:
(1) consumption today versus tomorrow and (2) consumption today versus
leisure.
\begin{enumerate}
  \item \emph{Preferences}:
    Utiliy given by
    \begin{align*}
      \sumtinfz \beta^t u(c_t,1-n_t)
      \qquad\beta\in(0,1)
    \end{align*}
    where $u$ is continuously twice differentiable with $u'>0$ and
    $u''<0$ (strictly increasing and strictly concave).  We also impose
    that $u$ satisfies the following Inada conditions which will help
    ensure an interior solution
    \begin{align*}
      \lim_{c\ra 0} \; u_1(c,1-n) = +\infty
      \qquad
      \lim_{n\ra 0} \; u_2(c,1-n) = 0
      \qquad
      \lim_{n\ra 1} \; u_2(c,1-n) = +\infty
    \end{align*}
    The first says that the consumer really, \emph{really} doesn't want
    to have zero consumption. The second says that the consumer gets
    less and less utility from a life of increasing leisure, while the
    third says that a bit of liesure is infinitely valuable if the
    household is working all of the time.

  \item \emph{Technology}:
    Output $y_t$ is produced by a CRS production function, capital
    $k_t$, labor $n_t$:
    \begin{align*}
      y_t &= F(k_t,n_t)
    \end{align*}
    for $F$ continuously twice differentiable, CRS (i.e. homogeneous of
    degree one or linear in both inputs), strictly increasing, strictly
    concave in $k$ and $n$ individually, and weakly concave (because
    linear) in $k$ and $n$ jointly. We impose the following Inada
    conditions on $F$ to ensure an interior solution:
    \begin{align*}
      F(0,n) &= 0
      \qquad
      \lim_{k\ra 0} F_1(k,n) = +\infty
      \qquad
      \lim_{k\ra \infty} F_1(k,n) = 0
    \end{align*}
    The first says that you need capital to produce. The second says
    as $k\ra 0$, it becomes very productive to have just a little $k$.
    The third says diminishing marginal returns.
    \\
    \\
    Output can be used for consumption $c_t$, investment $i_t$, or
    government purchases:
    \begin{align*}
      c_i + i_t + g_t &\leq y_t
    \end{align*}
    Investment is how the household accumulate capital, though
    depreciation eats away at the stock of capital at rate
    $\delta\in[0,1]$:
    \begin{align*}
      k_{t+1} &= (1-\delta)k_t + i_t
    \end{align*}

  \item \emph{Government}:
    We allow for a government that purchases $\{g_t\}\tinfz$ financed by
    tax rates $\{\tau_t^c,\tau_t^k,\tau_t^n\}\tinfz$ on consumption,
    earnings from capital, and wages, along with a lump-sum head taxes
    each period, $\{\tau^h_t\}\tinfz$.

  \item \emph{Endowments}:
    Each household has one unit of time to be split among labor and
    leisure each period, and initial capital level $k_0=\bar{k}_0$ is
    given.
\end{enumerate}
Note that we sometimes defined the production function differently,
using the fact that $F$ is CRS to note that
\begin{align*}
  F(k,n) &= n \cdot F(k/n,1)
\end{align*}
So then define
\begin{align*}
  f(\hat{k}) := F(\hat{k},1)
  \qquad\text{where}\quad
  \hat{k} = \frac{k}{n}
\end{align*}
Then the derivatives are
\begin{align*}
  F_1(k,n)
  &=
  \frac{d}{dk}[F(k,n)]
  =
  \frac{d}{dk}[n\cdot f(k/n)]
  = f'(k/n) \\
  &= f'(\hat{k}) \\
  F_2(k,n)
  &=
  \frac{d}{dn}[F(k,n)]
  =
  \frac{d}{dn}[n\cdot f(k/n)]
  = f(k/n) +
  n\cdot
  \frac{d}{dn}[F(k/n,1)] \\
  &= f(\hat{k}) - f'(\hat{k})\cdot \hat{k}
\end{align*}


\clearpage
\subsection{Social Planner's Problem}

The social planner ignores the government by setting $g_t$ and all tax
rates equal to zero for all periods. The SP then just maximizes
household's utility subject to feasibility constraints:
\begin{align*}
  \max_{\{c_t\},\{k_t\},\{n_t\}}
    &\sumtinfz \beta^t u(c_t,1-n_t) \\
    \text{s.t.} &\quad
    c_t + k_{t+1}
    \leq F(k_t,n_t) + (1-\delta) k_t\\
    &\quad c_t, k_t \geq 0
    \qquad n_t\in[0,1]
    \qquad k_0 = \bar{k}_0
\end{align*}
We can eliminate choice of $\{c_t\}$ and turn this into equivalent
problem
\begin{align*}
  \max_{\{k_t\},\{n_t\}}
    &\sumtinfz \beta^t
      u\big(F(k_t,n_t) + (1-\delta) k_t - k_{t+1}, \;1-n_t\big) \\
    \text{s.t.} &\quad
    F(k_t,n_t) + (1-\delta) k_t - k_{t+1} \geq 0 \\
    & \quad k_t \geq 0 \qquad n_t \in[0,1] \qquad
    k_0 = \bar{k}_0
\end{align*}
First order necessary conditions:
\begin{alignat*}{3}
  k_t:&&\qquad
  0 &=
  \beta^t u_1(c_t,1-n_t)
  \left[F_1(k_t,n_t)+(1-\delta)\right]
  - \beta^{t-1}u_1(c_{t-1},1-n_{t-1})
  \\
  n_t:&&\qquad
  0
  &=
  \beta^t u_1(c_t,1-n_t)F_2(k_t,n_t) - \beta^t u_2(c_t,1-n_t)
\end{alignat*}
Then the pareto efficient allocation is then completely characterized by
\begin{align}
  \frac{u'(c_{t-1},1-n_{t-1})}{\beta u'(c_{t},1-n_t)}
  &= F_1(k_t,n_t) + (1-\delta) \notag \\
  \frac{u_2(c_t,1-n_t)}{u_1(c_t,1-n_t)} &= F_2(k_t,n_t) \\
  c_t &= F(k_t,1) + (1-\delta)k_t - k_{t+1}\notag\\
  \limt \beta^{t-1}u'(c_{t-1},1-n_t) k_t &= 0 \notag\\
  k_0 &= \bar{k}_0\notag
\end{align}
The first equation says MRS = MRT. On the LHS, it's clear that the
quantity represents the marginal rate of substitution between
consumption at $t-1$ and consumption at $t$. On the RHS, it's less
clear, but follows from the fact that decreasing consumption by one unit
to but capital increases tomorrow's consumption by $F_1(k_t,n_t)$ and
allows the individual to decrease investment by $(1-\delta)$ next period
since we carried extra capital forward.
The second equation \emph{also} says MRS = MRT, where the LHS is the
MRS between leisure and consumption while the RHS is the extra
production from giving up a little more leisure.

We could alternatively express the FOCs interns of $f$, rather than $F$:
\begin{align}
  \frac{u'(c_{t-1},1-n_{t-1})}{\beta u'(c_{t},1-n_t)}
  &= f'(\hat{k}_t) + (1-\delta) \notag \\
  \frac{u_2(c_t,1-n_t)}{u_1(c_t,1-n_t)} &= f(\hat{k}_t) - \hat{k}_t\cdot
  f'(\hat{k}_t) \notag \\
  c_t &= n_t f(\hat{k}_t) + (1-\delta)n_t \hat{k}_t - n_{t+1} \hat{k}_{t+1}\notag
\end{align}
Let $n_*$, and $\hat{k}_*$ denote the steady values, and substitute
$c_t$ into the first two equations to arrive at the following steady
state equations:
\begin{align}
  \frac{1}{\beta}
  &= f'(\hat{k}_*) + (1-\delta) \notag \\
  \frac{u_2\big(n_* \left[f(\hat{k}_*) - \delta\hat{k}_*\right],\;1-n_*\big)}{%
    u_1\big(n_* \left[f(\hat{k}_*) - \delta\hat{k}_*\right],\;1-n_*\big)}
    &= f(\hat{k}_*) - \hat{k}_*\cdot
  f'(\hat{k}_*) \notag
\end{align}
Two equations in two unknowns, $n_*$ and $\hat{k}_*$. The first equation
pins down $\hat{k}_*$, and it does so uniquely by the Inada conditions.
The second equation can be written as
\begin{align*}
  \frac{u_2\big(n_* B_2,\;1-n_*\big)}{%
    u_1\big(n_* B_2,\;1-n_*\big)}
    &= B_1
\end{align*}
where $B_1$ and $B_2$ are constants (since $\hat{k}_*$ was determined by
the first equation) that equal
\begin{align*}
  B_1 &= f(\hat{k}_*) - \hat{k}_*\cdot f'(\hat{k}_*) \\
  B_2 &= f(\hat{k}_*) - \delta\hat{k}_*
\end{align*}
There always exists at least one solution, but in general there is no
unique solution unless we assume $B_1$ and $B_2$ are normal goods or
$B_1=B_2$.

\clearpage
\subsection{Arrow-Debreu Competetive Equilibrium (ADCE)}

Here, the government matters.
In this subsection, we formulate an
\emph{Arrow-Debreu Competetive Equilibrium} (ADCE) for a simple
production-based economy involving households that consume output,
supply labor, and own capital along with firms that produce output by
buying labor and renting capital from the households (paying a rental
rate).

Note that there will be no real link between time periods for capital.
You can change capital a lot from $k_t$ to $k_{t+1}$. You could link up
time periods by adding adjustment costs, a feature we ignore for now.

In this context, and ADCE is a list of sequences of
$\{c_t^*\}$  Consumption,
$\{k_t^*\}$  Capital,
$\{h_t^*\}$  Hours,
$\{p_t^*\}$  Prices,
$\{w_t^*\}$  Wages,
$\{r_t^*\}$  Rate of return on capital, and
$\{T_t^*\}$ Transfers
that satisfy the following conditions:

\begin{enumerate}
  \item \emph{Household Optimization}: Taking prices,
    wages, and the rate of return on capital
    ($\{p^*_t\}$, $\{w^*_t\}$, $\{r^*_t\}$) as given, the
    sequences for consumption, capital, and hours of labor
    ($\{c_t^*\}$, $\{k_t^*\}$, and $\{h_t^*\}$)
    solve the utility maximization problem
    \begin{align}
      (\{c_t^*\}, \{k_t^*\}, \{h_t^*\})
      =
      \argmax_{\{c_t\}, \{k_t\}, \{h_t\}}
        \; &\sumtinfz \beta^t u(c_t)
        \label{defn:adce-hh-objfcn}\\
      \text{s.t.} \; &
        \sumtinfz p^*_t(c_t + k_{t+1}-(1-\delta)k_t) \leq
        \sumtinfz (r^*_t k_t + w^*_t h_t)
        \label{defn:adce-hh-budget}\\
      c_t &\geq 0 \notag\\
      h_t &\in [0,1] \notag\\
      k_0 &= \bar{k}_0 \; \text{given} \notag
    \end{align}
    In other words the ``star'' sequences correspond exactly to what the
    household optimizing household would choose to do, taking things
    outside of their control as given.

    A few remarks:
    \begin{enumerate}
      \item Inequality~\ref{defn:adce-hh-budget} acts as a budget
        constraint that stipulates total lifetime spending on
        consumption and capital must be less than or equal to total
        lifetime capital-rental income and labor income. Note that it is
        a single budget constraint for time zero, not a sequence of
        budget constraints each period.

      \item Outside of the budget constraint, the remaning constraints
        enforce nonnegative consumption, supply of hours limited by
        hours in the day (normalized to one), and capital given.

      \item There is no non-negativity constraint on capital since the
        firm's production function will be defined for positive capital
        values only. Hence they will never demand negative capital, so
        we can leave it out of the constraints here.

      \item Labor $h_t$ is not in the utility function, so it is pretty
        obvious that the household would choose to supply $h_t=1$ units
        of labor for all $t$. That earns housholds the most consumption
        (which they value) at the cost of leisure (which we assume they
        don't care about).

        So it might seem like we could have left the $\{h_t\}$ out of
        the definition of equilibrium altogether. However, that is not
        the case. Even though households will choose to supply one unit
        of labor, firms don't know that. We must keep the labor decision
        in the model because that will allow us to pin down the wage
        rate.
    \end{enumerate}

  \item \emph{Firm Optimization}: Taking
    prices, wages, and the rate of return on capital
    ($\{p^*_t\}$, $\{w^*_t\}$, $\{r^*_t\}$) as given,
    the sequences for capital to rent and labor hours to buy
    ($\{k_t^*\}$ and $\{h_t^*\}$)
    solve the profit maximization problem
    \begin{align}
      (\{k_t^*\}, \{h_t^*\})
      =
      \argmax_{\{k_t\}, \{h_t\}}
        \; &\sumtinfz \beta^t (p^*_t F(k_t,h_t) - w^*_t h_t - r^*_t k_t)
        \label{defn:adce-firm-objfcn}\\
      \text{s.t.} \;
      &k_t \geq 0 \notag\\
      &h_t \geq 0 \notag
    \end{align}
    A few remarks:
    \begin{enumerate}
      \item Firms don't worry about the fact that we must have
        $h_t\leq 1$. To them, they can buy as many labor hours as they
        want at rate $w^*_t$. In reality, the household optimization
        side of the equilibrium will enforce $h_t\leq 1$.

      \item Though there does not appear to be any discounting in the
        firm's objective function, it is implicit in the prices. As
        we'll see below, $p_t\ra 0$, which will take care of the
        discounting.
    \end{enumerate}

  \item \emph{Government}: For each $t$:
    \begin{align}
      \tau_k r^*_t k^*_t = T^*_t
      \label{taxes-govt}
    \end{align}

  \item \emph{Market Clearing}: For each $t$:
    \begin{align}
      F(k^*_t,h_t^*) = c_t^* + k^*_{t+1} - (1-\delta)k_t^*
      \label{taxes-clear}
    \end{align}
\end{enumerate}
We are now in a position to characterize equilibrium. Rather than appeal
to the welfare theorem to say that the outcome is Pareto optimal (hence
it looks exactly like the outcome of the planning problem), we will look
at the first order conditions to the different optimization problems we
have. It turns out that they \emph{will} match the planning problem,
which will offer a kind of proof of the first welfare theorem.
\begin{enumerate}
  \item \emph{Household FOCs}: Again there is a single budget
    constraint at time zero, not one for each period. So
    Inequality~\ref{defn:adce-hh-budget} has only one associated
    multiplier, $\mu$. Therefore, differentiating with respect to
    consumption and capital, we get FOCs for time $t$ as:
    \begin{align}
      \beta^t u'(c_t) &= \mu p_t^* \label{hhfoc1}\\
      \mu[r_t^* + p_t^* (1-\delta)]
      &= \mu p_{t-1}^* \label{hhfoc2}
    \end{align}
    while clearly $h_t=1$.

    These are necessary conditions for optimal $c_t$ that follow from
    the fact that $u'(0)=\infty$, so we have an interior solution,
    implying the KKT conditions are necessary.

  \item \emph{Firm FOCs}: We have
    \begin{align}
      p^*_t F_1(k_t,h_t) &= r_t^* \label{firmfoc1}\\
      p^*_t F_2(k_t,h_t) &= w_t^* \notag
    \end{align}
    Notice that capital appears nowhere in those equations.
    We instead have Equation~\ref{firmfoc1} relating \emph{prices},
    rather than quantities of capital. This is called a
    \emph{no arbitrage condition}. More on that later.

  \item \emph{Transversality Condition}:
    Think about a finite-time version of this problem. The household has
    to choose consumption and investment for the last period, denoted
    time $T$. At $T$, the household can either consume output in the
    form of $c_T$ or invest to keep a positive $k_{T+1}$. But since $T$
    is the last period, investing output to keep $k_{T+1}>0$ looks
    pretty dumb when you could instead use that output for higher
    consumption $c_T$.  So it must be that \emph{either} $k_{T+1}=0$
    (i.e.\ you consume all output in the last period and invest nothing)
    or the value of consumption---the marginal utility
    $u'(c_T)$---equals zero so that more consumption $c_T$ isn't
    actually worth shit. In math, you'd need
    \begin{align*}
      \beta^{T} u'(c_T) k_{T+1} = 0
    \end{align*}
    The transversality condition is the infinite horizon analog to this
    problem, written
    \begin{align*}
      \limt \beta^t u'(c_t) k_{t+1}=0
    \end{align*}

  \item \emph{Pareto Optimality}: We want to show the competetive
    equilibrium matches the solution to the planning problem. Since
    we're considering the equilibrium sequences, everything will have
    stars ${}^*$.

    Start by dividing Equation~\ref{hhfoc1} at time $t-1$ by its time
    $t$ analog to get
    \begin{align}
      \frac{u'(c_{t-1}^*)}{\beta u'(c_{t}^*)} = \frac{p_{t-1}^*}{p_t^*}
      \label{pratio1}
    \end{align}
    Take household FOC Equation~\ref{hhfoc2}, cancel $\mu$'s, and divide
    by $p_t^*$:
    \begin{align*}
      \frac{r_t^*}{p_t^*} + (1-\delta)
      &= \frac{p_{t-1}^*}{p_t^*}
    \end{align*}
    Into the above equation, substitute Equation~\ref{firmfoc1} in for
    $r_t^*$:
    \begin{align}
      F_1(k_t,h_t) + (1-\delta)
      &= \frac{p_{t-1}^*}{p_t^*}
      \label{pratio2}
    \end{align}
    How equate Equations~\ref{pratio1} and \ref{pratio2}:
    \begin{align*}
      \frac{u'(c_{t-1}^*)}{\beta u'(c_{t}^*)}
      = F_1(k_t,h_t) + (1-\delta)
    \end{align*}
    So we have this, together with market clearing, $h_t=1$, the
    transversality condition, and an initial capital level:
    \begin{align*}
      \frac{u'(c_{t-1}^*)}{\beta u'(c_{t}^*)}
      &= F_1(k_t,h_t) + (1-\delta) \\
      F(k_t,h_t) &= c_t + k_{t+1} - (1-\delta) k_t \\
      h_t &= 1\\
      \limt \beta^t u'(c_t) k_{t+1}&=0\\
      k_0 &= \bar{k}_0 \; \text{given}
    \end{align*}
    These are exactly the conditions that characterized the Pareto
    efficient allocations from the planning problem.

  \item \emph{Prices}: Normalize $p_0^*=1$, which will also remove
    indeterminacy problems. We get the wage and capital rental rates
    from the firm's first order conditions:
    \begin{align*}
      r_t^* &= p_t^* F_1(k^*_t,h^*_t) \\
      w_t^* &= p_t^* F_2(k^*_t,h^*_t)
    \end{align*}
    We get tomorrow's price by Solving Equation~\ref{pratio1} for
    $p_{t+1}$:
    \begin{align}
       p_t^*
       = p_{t-1}^*\beta \frac{u'(c_{t}^*)}{u'(c_{t-1}^*)}
    \end{align}

  \item \emph{Government Waste}: Suppose that the government did not
    lump-sum capital income taxes back to households. Suppose instead
    that the government just buries the output. Then there will be
    changes to equilibrium.

    Specifically, if the government wastes taxes revenue, replace
    sequence $\{T^*_t\}$ with $\{G^*_t\}$, and remove $T^*_t$ terms from
    the household budget constraint, since they never see the tax
    %revenue.  Equation~\ref{defn:adce-hh-budget-taxes} becomes
    \begin{align*}
        \sumtinfz p^*_t(c_t + k_{t+1}-(1-\delta)k_t) &\leq
        \sumtinfz ((1-\tau_k)r^*_t k_t + w^*_t h_t)
    \end{align*}
    We also modify the Government Budget Equation~\ref{taxes-govt} and
    Market Clearing Equation~\ref{taxes-clear}
    \begin{align*}
      G^*_t &=  \tau_k r^*_t k^*_t \\
      F(k^*_t,h_t^*) &= c_t^* + k^*_{t+1} - (1-\delta)k_t^* + G^*_t
    \end{align*}
    Of the key equations summarizing the ADCE allocation, only the
    market clearing constraint (which pins down the level of
    consumption) is affected. We see that the government waste reduces
    consumption.
    Notably, however, the consumption Euler equation does not change. In
    other words, households don't change how they allocate cash money
    across time---they just need to reduce their consumption by the
    amount of waste in each period.
\end{enumerate}
Lastly, a \emph{steady state ADCE} is a value $k^*$ and an ADCE for the
economy with $\bar{k}_0=k^*$ and $\{k_t^*\}$ satisfying $k^*_t=k^*$ for
all $t$. Consumption must be a constant $c^*$ because solving the market
clearing equation for consumption expresses consumption as a function of
constants:
\begin{align*}
  c^* := c_t^* = F(k^*,1) - \delta k^*
  \qquad \forall t
\end{align*}
Therefore, by Equation~\ref{pratio1}
\begin{align*}
  \frac{u'(c^*)}{\beta u'(c^*)} &= \frac{p_{t-1}^*}{p_t^*} \\
  \implies \quad p_t &= \beta p_{t-1}^* = \beta^t p_0^*
\end{align*}
Hence, prices are \emph{not} constant---they are falling. The same logic
can be used to show that wages and rental rates are falling
monotonically in steady state:
\begin{align*}
  r_t^* &= p_t^* F_1(k^*,1) = \beta^t p_0^* F_1(k^*,1) = \beta^t r_0^*\\
  w_t^* &= p_t^* F_2(k^*,1) = \beta^t p_0^* F_2(k^*,1) = \beta^t w_0^*
\end{align*}
Hence we have justified the earlier claim that ``prices embed
discounting'' within the firm's optimization problem.

\subsection{Rates of Return in an ADCE}

There are two ways for the consumer to move money through time in an
ACDE, with two corresponding rates of return:
\begin{enumerate}
  \item \emph{Real Rate of Return}, $R_t^*$: Give up one unit of
    consumption today, saving $p_t^*$, and buy $\frac{p_t^*}{p_{t+1^*}}$
    units of consumption tomorrow:
    \begin{align}
      1+R_t^* = \frac{p_t^*}{p_{t+1}^*} = \frac{1}{\beta}
      \label{noarb1}
    \end{align}
    where the last equality followed from a steady relationship.

  \item \emph{Real Rate of Return on Capital}: Give up one unit of
    consumption today, invest in capital, and use all proceeds from the
    capital to consume at time $t+1$
    \begin{align}
      \frac{r_{t+1}^* + (1-\delta)p_{t+1}^*}{p_{t+1}^*}
      \label{noarb2}
    \end{align}
    In words, you give up one unit of consumption today and instead buy
    one unit of capital for use tomorrow.
    First, that extra unit of capital gets you extra rental income
    $r_{t+1}^*$ tomorrow.
    Second, you also get the liquidation value of that unit of capital
    (net of depreciation) at tomorrow's price $(1-\delta)p_{t+1}^*$
    The sum of these two things $r_{t+1}^* + (1-\delta)p_{t+1}^*$ is the
    numerator.

    Lastly, you gave up one unit of consumption today at price $p_t^*$,
    but consumption will be priced differently tomorrow.  So we should
    divide this extra consumption tomorrow by $p_{t+1}^*$ to make the
    periods comparable. That's the denominator.
\end{enumerate}
So we've established two ways to move money through time: via simple
reallocation of consumption and via investment. By any reasonable notion
of equilibrium, we would expect no arbitrage, i.e.\ for
Equation~\ref{noarb1} (in whichever of the three representations we
choose) to equal Equation~\ref{noarb2}:
\begin{align*}
  \frac{p_t^*}{p_{t+1}^*}
  &=
  \frac{r_{t+1}^* + (1-\delta)p_{t+1}^*}{p_{t+1}^*} \\
  \Leftrightarrow\quad
  \frac{p_t^*}{p_{t+1}^*}
  &=
  \frac{r_{t+1}^*}{p_{t+1}^*} + (1-\delta)
\end{align*}
But recall that this equation popped out of the ADCE. It was also the
reason why the FOC for capital didn't have the \emph{quantity} of
capital involved, but rather this no arbitrage condition (implicitly).



\clearpage
\subsection{Solow Model}

Fixed output-share of investment each period, $s$. Capital evolves
according to
\begin{align*}
  k_{t+1} &= sf(k_t) + (1-\delta)k_t \\
  k_0 &= \hat{k}_0
\end{align*}
By investment equation, steady state capital must satisfy
\begin{align*}
  k^* &= sf(k^*) + (1-\delta)k^*\\
  \Leftrightarrow\quad
  \frac{\delta}{s} k^* &= f(k^*)
\end{align*}



\clearpage
\section{Economic Growth}

\subsection{Exogenous Growth}

\subsection{Endogenous Growth}

We modify the time-homogeneous production function. There's three ways
you can do it
\begin{enumerate}
  \item $y_t = F(A_t k_t,h_t)$: Capital augmenting
  \item $y_t = F(k_t,A_t h_t)$: Labor augmenting
  \item $y_t = A_t F(k_t,h_t)$: Neutral or factor neutral technological
    change because it affects the production function generally---not
    just one of the factors. It's as if the production function displays
    constant returns to scale, so you augment both factors and the
    constant $A_t$ gets pulled out in front.
\end{enumerate}
Note that for something like Cobb-Douglas, there's no difference.

\subsubsection{Baseline Growth Model}

We set up the model
\begin{enumerate}
  \item \emph{Preferences}: $\sumtinfz \beta^t u(c_t)$
  \item \emph{Technology}: Assume $\{A_t\}$ given, so deterministic
    technology growth at a constant rate (for now).\footnote{%
      Add randomness and you get RBC models.}
    We go for labor-augmenting technological change.
    \begin{align*}
      y_t &= F(k_t,A_th_t) \\
      y_t &= c_i + i_t \\
      k_{t+1} &= (1-\delta)k_t + i_t
    \end{align*}
  \item \emph{Endowments}: One unit of time for labor each period, and
    $k_0=\bar{k}_0$.
\end{enumerate}
This leads to social planner problem.
\begin{align*}
  \max_{\{c_t\},\{k_t\}}
    &\sumtinfz \beta^t u(c_t) \\
    \text{s.t.} &\quad
    c_t + k_{t+1}
    = F(k_t,A_t) + (1-\delta) k_t\\
    &\quad c_t \geq 0 \\
    &\quad k_0 = \bar{k}_0
\end{align*}
Then the pareto efficient allocation is completely characterized by
\begin{align}
  \frac{u'(c_{t-1}}{\beta u'(c_{t})}
  &= F_1(k_t,A_t) + (1-\delta) \label{eulerA}\\
  c_t &= F(k_t,A_t) + (1-\delta)k_t - k_{t+1}\notag\\
  \limt \beta^{t-1}u'(c_{t-1}) k_t &= 0 \notag\\
  k_0 &= \bar{k}_0\notag
\end{align}
We will now attempt to find a \emph{balanced growth path}, which is the
natural generalization of steady state that considers asymptotic
behavior. A balanced growth path is a solution in which all of the
variables grow at \emph{constant} rates, though \emph{not necessarily}
the same rate.\footnote{%
  For our simple model, it will be the case that things grow at the same
  rate. But the concept of a ``balanced growth path'' is more general.
}

So we know that $A_t$ grows at some constant rate $g$. We want $k_t$ and
$c_t$ to grow at a constant rates $g_k$ and $g_c$ as well, though they
could differ from $g$. So we want
\begin{align*}
  c_t &= F(k_t,A_t) + (1-\delta) k_t - k_{t+1} \\
  (1+g_c) c_0 &= F((1+g_k)k_t,(1+g)^tA_0) + (1-\delta) k_t - k_{t+1} \\
\end{align*}
For $c_t$ to grow at a constant rate, we need $g_k=g$. Then we can pull
out $(1+g)$ from inside the production function and everything on the
RHS grows at $g$. Then $c_t$ grows at rate $g$ too.

Next, notice that since $k_t$ and $A_t$ are growing at $g$, the ratio
between the goods is not changing. Hence $F_1(k_t,A_t)$ is constant
since the derivative is homogeneous of degree zero (which follows from
$F$ being HoD1).

\subsubsection{Baseline with Change of Variables}

Since everything is growing at rate $g$, define
$\tilde{k}_t = \frac{k_t}{(1+g)^t}$ or equivalently
$k_t=(1+g)^t\cdot \tilde{k}_t$. Moreover, normalize $A_0=1$ and
substitute $A_t=(1+g)^t$. Substitute. Then the Social Planner's problem
becomes
\begin{align*}
  \max_{\{k_t\}}
    &\sumtinfz \beta^t u\left[F\left((1+g)^t\tilde{k}_t,(1+g)^{t}\right)
      + (1-\delta) (1+g)^t\tilde{k}_t - (1+g)^t\tilde{k}_{t+1}\right] \\
    \text{s.t.} &\quad
    F((1+g)^t\tilde{k}_t,(1+g)^t) + (1-\delta) (1+g)^t\tilde{k}_t
      - (1+g)^t\tilde{k}_{t+1}\geq 0\\
    &\quad k_0 = \bar{k}_0
\end{align*}
We can pull out $(1+g)^t$ in both the objective function and the
constraint to simplify to
\begin{align*}
  \max_{\{k_t\}}
    &\sumtinfz \beta^t u\left[F\left(\tilde{k}_t,\right)
      + (1-\delta) (1+g)^t\tilde{k}_t - (1+g)^t\tilde{k}_{t+1}\right] \\
    \text{s.t.} &\quad
    F((1+g)^t\tilde{k}_t,(1+g)^t) + (1-\delta) (1+g)^t\tilde{k}_t
      - (1+g)^t\tilde{k}_{t+1}\geq 0\\
    &\quad k_0 = \bar{k}_0
\end{align*}

Then the pareto efficient allocation is completely characterized by
\begin{align}
  \frac{u'(c_{t-1}}{\beta u'(c_{t})}
  &= F_1(k_t,A_t) + (1-\delta) \\
  c_t &= F(k_t,A_t) + (1-\delta)k_t - k_{t+1}\notag\\
  \limt \beta^{t-1}u'(c_{t-1}) k_t &= 0 \notag\\
  k_0 &= \bar{k}_0\notag
\end{align}
We will now attempt to find a \emph{balanced growth path}, which is the
natural generalization of steady state that considers asymptotic
behavior. A balanced growth path is a solution in which all of the
variables grow at \emph{constant} rates, though \emph{not necessarily}
the same rate.\footnote{%
  For our simple model, it will be the case that things grow at the same
  rate. But the concept of a ``balanced growth path'' is more general.
}

So we know that $A_t$ grows at some constant rate $g$. We want $k_t$ and
$c_t$ to grow at a constant rates $g_k$ and $g_c$ as well, though they
could differ from $g$. So we want
\begin{align*}
  c_t &= F(k_t,A_t) + (1-\delta) k_t - k_{t+1} \\
  (1+g_c) c_0 &= F((1+g_k)k_t,(1+g)^tA_0) + (1-\delta) k_t - k_{t+1} \\
\end{align*}
For $c_t$ to grow at a constant rate, we need $g_k=g$. Then we can pull
out $(1+g)$ from inside the production function and everything on the
RHS grows at $g$. Then $c_t$ grows at rate $g$ too.

Next, notice that since $k_t$ and $A_t$ are growing at $g$, the ratio
between the goods is not changing. Hence $F_1(k_t,A_t)$ is constant
since the derivative is homogeneous of degree zero (which follows from
$F$ being HoD1).


\clearpage
\subsection{Romer Model}

\subsubsection{Preferences, Technology, Endowments}

Specialization drives productivity. Primitives
\begin{enumerate}
  \item \emph{Preferences}: $\sumtinfz \beta^t u(c_t)$ with
    $u(c)=\frac{c^{1-\sigma}-1}{1-\sigma}$ for $\sigma>0$.
  \item \emph{Technology}:
    Output $y_t$ is produced by spreading out aggregate capital $k_t$
    among a mass of $N_t$ production processes that all use capital
    differently:
    \begin{align*}
      y_t &=
      \left(
      \int_{0}^{N_t} k_t(i)^\alpha \;di \right)
      h_t^{1-\alpha} \\
      k_t &= \int_0^{N_t} k_t(i) \; di
    \end{align*}
    where $N_t$ is an index of specialization that will grow over time
    as additional (specialized) production processes come into
    existence through R\&D. But given $N_t$ fixed, note that the
    production function is CRS.

    Output can be used for consumption, investment in aggregate
    capital, or investment in finding more production processes
    (i.e.\ R\&D).
    \begin{align*}
      y_t &= c_t + i_t^k + i_t^N \\
      k_{t+1} &= (1-\delta)k_t + i_t^k \\
      N_{t+1} &= N_t + i_t^N
    \end{align*}

  \item \emph{Endowments}: Each household has one unit of time, while
    capital and the number of production processes start at
    $k_0=\bar{k}_0$ and $N_0=\bar{N}_0$.
\end{enumerate}
Note that there are no irreversibilities, so the stock of knowledge can
be turned back into consumption $c$, but that won't be a problem since
we'll be finding a BGP.


\subsubsection{Social Planner's Problem}

First, we know that aggregate capital will be spread out equally among
the production processes, so that $k_t(i) = \frac{k_t}{N_t}$. Therefore
\begin{align*}
  \int_0^{N_t} k_t(i)^\alpha \; di
  &=
  \int_0^{N_t} \left(\frac{k_t}{N_t}\right)^\alpha \; di
  =
  \left(\frac{k_t}{N_t}\right)^\alpha N_t
  = k_t^\alpha N_t^{1-\alpha}
\end{align*}
Coupled with the fact that $h_t=1$, this allows us to write the
production function more compactly as
\begin{align*}
  F(k_t,h_t)
  &= \left( \int_0^{N_t} k_t(i)^\alpha \; di\right)
    h_t^{1-\alpha}
  = k_t^{\alpha} N_t^{1-\alpha}
\end{align*}
This allows us to write the social planner's problem
\begin{align*}
  \max_{\{k_t\},\{N_t\}} \; & \sumtinfz \beta^t u(c_t) \\
  \text{s.t.} \; &
    c_t =
    k_t^\alpha N_t^{1-\alpha}
    - [k_{t+1}-(1-\delta)k_t] + [N_{t+1}-N_t] \\
    & k_0 = \bar{k}_0 \\
    & N_0 = \bar{N}_0 \\
    & c_t, k_t,N_t\geq 0
\end{align*}
Hence, first order conditions
\begin{align*}
  \frac{u'(c_{t-1})}{\beta u'(c_t)}
  &=
  \alpha \left(\frac{k_t}{N_t}\right)^{\alpha-1} + (1-\delta) \\
  \frac{u'(c_{t-1})}{\beta u'(c_t)}
  &=
  (1-\alpha) \left(  \frac{k_t}{N_t} \right)^{\alpha} + 1
\end{align*}
Equating
\begin{align*}
  \alpha \left(\frac{k_t}{N_t}\right)^{\alpha-1} + (1-\delta)
  &=
  (1-\alpha) \left(  \frac{k_t}{N_t} \right)^{\alpha} + 1
\end{align*}
This needs to be true at each $t$, hence $\frac{k_t}{N_t}$ is a
constant i.e.
\begin{align*}
  \frac{1}{\tilde{A}} = \frac{k_t}{N_t}
  \quad\implies\quad
  N_t = \tilde{A}k_t
\end{align*}
Moreover, there's a unique value for the ratio since the RHS is
increasing in $\frac{k_t}{N_t}$, while the LHS is decreasing.
\\
\\
And if we plug this back into the Euler Equation
\begin{align*}
  \frac{u'(c_{t-1})}{\beta u'(c_t)}
  &=
  \alpha \left(\frac{1}{\tilde{A}}\right)^{\alpha-1} + (1-\delta)
\end{align*}
which is exactly identical to the $Ak$ model where
$A=\alpha \left(\frac{1}{\tilde{A}}\right)^{\alpha-1}$.


\clearpage
\subsubsection{MCE with R\&D plus Entry}

Output $y_t$ is the ``final good'' produced by mixing many intermediate
goods $z_t(i)$ according to production function
\begin{align*}
  y_t = \left( \intzN z_t(i)^\alpha \; di \right) h_t^{1-\alpha}
\end{align*}
The intermediate goods are produced directly by capital, rather than the
final good as we've had before.
\begin{enumerate}
  \item \emph{Firm Optimization}:
    There are now three types of firms, each with their own optimization
    problems:
    \begin{enumerate}
      \item \emph{Final Goods Producers}:
        These take a variety of intermediate goods and produce a homo
        \begin{align*}
          \max_{z_t} \; & p^*_{z,t} z_t
        \end{align*}

      \item \emph{R\&D Sector}: These firms have linear technology in
        producing new intermediate products. They are monopolists on
        intermediate products---no other firm can create new
        intermediate products. Profits must be zero,
        \begin{align*}
          p_t^* (p_{N,t}^*-1) &= 0 \\
          N_0^* &= \bar{N}_0
        \end{align*}
        I multiplied by $p_t^*$ to normalize all prices. Within
        parentheses, we see that it costs one unit to create a new where
        $p_{N,t}^*$ is the price that it can be sold at.

      \item \emph{Intermediate Goods Sector}:
        \begin{align*}
          \max_{k_{z,t}, \; p_{z,t}}
          p_{z,t} \, k_{z,t}
          - r_t^* k_{z,t}
        \end{align*}

    \end{enumerate}
    With each firm taking \emph{demand}
    (not prices this time) $d^*(p)$ as given, $p^*$ and $h^*(i)$
    solve the profit maximization problem:
    \begin{align*}
      (p^*(i),h^*(i))
      &=
      \max_{p(i),h(i)}
      p(i) Ah(i) - h(i) \\
      \text{s.t.} \;
      & \; Ah(i) = d_i^*[p(i)] \\
      & \; h(i) \geq 0\\
      & \; \pi^*(i) = p^*(i) Ah^*(i) - h^*(i)
    \end{align*}

  \item \emph{Household Optimization}: Taking prices $p^*$ as given,
    consumption $c^*(i)$ and total labor supply $h^*$ solve
    \begin{align*}
      (c^*(i), h^*)
      = \max_{c(i), h}
        & \; u\left(
          \left[ \int_0^N c(i)^\rho \; di \right]^{1/\rho}
        \right)\\
      \text{s.t} & \;
        \intzN p^*(i) c(i) \; di \leq h \\
      &\; h\in[0,1] \\
      &\; c(i) \geq 0
    \end{align*}
    while also $d^*(p)$ is the optimal choice each good as a function of
    price, holding all other prices and profits constant.

  \item \emph{Market Clearing}: All of the labor provided to the
    different firms must aggregate to the amount of total labor
    provided, and everything produced must be consumed:
    \begin{align*}
       h^* &= \intzN h^*(i) \; di \\
       c^*(i) &= Ah^*(i)
    \end{align*}
\end{enumerate}




\clearpage
\section{Static Model with Variety in Variety}


We define the usual trifecta of primitives for a macro problem:
\begin{enumerate}
  \item \emph{Preferences}:
    Given mass of goods $N$ and the preference parameter $\rho\in(0,1)$,
    define utility over consumption of a continuum of goods, captured by
    function $c:[0,N]\ra \R$, as
    \begin{align*}
      U(c) &=
      u\left(
      \left[
      \int_0^N [a(i)c(i)]^\rho \; di
      \right]^{1/\rho}
      \right)
    \end{align*}

  \item \emph{Technology}:
    There is a variety of goods to consume, each of which is produced by
    a different firm, so we need to define the production function for
    each firm:
    \begin{align*}
      y(i) = A(i) h(i)
    \end{align*}
    where $y(i)$ is output of the $i$th good from the $i$th firm, $A(i)$
    is productivity in producing the $i$th good, and $h(i)$ is labor
    used to produce the $i$th good.

  \item \emph{Endowments}: Each household has one unit of labor to
    supply to the firms.
\end{enumerate}
Social planner's problem
\begin{align*}
  \max_{c(i),h(i)}
  &\;
  u\left( \left[ \int_0^N [a(i)c(i)]^\rho \; di \right]^{1/\rho} \right)
  \\
  \text{s.t.}
  &\; \intzN h(i) \; di = 1 \\
  &\; c(i) = A(i) h(i) \\
  &\; c(i),h(i)\geq 0
\end{align*}
Eliminate $h(i)$ and use the fact that $u$ is increasing to rewrite the
problem as just the maximization of CES-weighted consumption:
\begin{align*}
  C=
  \max_{c(i)\geq 0}
  &\;
  \left[ \int_0^N [a(i)c(i)]^\rho \; di \right]^{1/\rho}
  \\
  \text{s.t.}
  &\; \intzN \frac{c(i)}{A(i)} \; di = 1
\end{align*}
where $C$ is CES-weighted consumption at the maximum.
FOCs with respect to $c(i)$:
\begin{align*}
  \frac{\lambda}{A(i)}
  &=
  \frac{1}{\rho}\left[
    \int_0^N [a(i)c(i)]^\rho \; di
  \right]^{\frac{1}{\rho}-1}
  \rho [a(i) c(i)]^{\rho-1} a(i)
  \\
  \frac{\lambda}{A(i)}
  &=
  C^{1-\rho}
  a(i)^\rho c(i)^{\rho-1}
  \\
  \frac{1}{A(i)}
  &=
  \lambda^{-1}
  C^{1-\rho}
  a(i)^\rho c(i)^{\rho-1}
\end{align*}
Subbing this into the constraint
\begin{align*}
  1&=
  \intzN \frac{c(i)}{A(i)} \; di
  =
  \intzN
    c(i)
    \lambda^{-1} C^{1-\rho} a(i)^\rho c(i)^{\rho-1}
    \; di \\
  \lambda &=
  C^{1-\rho}
  \intzN
    [a(i)c(i)]^{\rho}
    \; di \\
  \lambda &= C^{1-\rho} C^\rho = C
\end{align*}
Therefore, we have identified $\lambda = C$. Using this and solving the
FOC for $c(i)$, you get
\begin{align*}
  c(i)
  &=
  \left(
  \frac{C^{\rho}}{A(i)a(i)^\rho}
  \right)^{\frac{1}{\rho-1}}
  %=
  %\left(\frac{C}{a(i)}\right)^{\frac{\rho}{\rho-1}}
  %A(i)^{\frac{1}{1-\rho}}
  =
  A(i)
  \left(\frac{A(i)a(i)}{C}\right)^{\frac{\rho}{1-\rho}}
\end{align*}
Subbing this into the definition of $C$
\begin{align*}
  C
  = \left[ \int_0^N [a(i)c(i)]^\rho \; di \right]^{1/\rho}
  &=
  \left[ \int_0^N
    \left[a(i)
    \left(
    \frac{C^{\rho}}{A(i)a(i)^\rho}
    \right)^{\frac{1}{\rho-1}}
    \right]^\rho \; di \right]^{1/\rho} \\
  C
  &=
  \left[ \int_0^N
    \left[
    A(i)a(i)
    \right]^{\frac{\rho}{1-\rho}}
    \; di \right]^{\frac{1-\rho}{\rho}}
\end{align*}
Hence, consumption can be written
\begin{align*}
  c(i)
  &=
  A(i)
  \left(\frac{A(i)a(i)}{C}\right)^{\frac{\rho}{1-\rho}} \\
  &=
  A(i)
  \frac{[A(i)a(i)]^{\frac{\rho}{1-\rho}}}{%
    \int_0^N \left[ A(i)a(i) \right]^{\frac{\rho}{1-\rho}} \; di
  }
\end{align*}
Hence, labor allocation is
\begin{align*}
  h(i) =
  \frac{[A(i)a(i)]^{\frac{\rho}{1-\rho}}}{%
    \int_0^N \left[ A(i)a(i) \right]^{\frac{\rho}{1-\rho}} \; di
  }
\end{align*}


\clearpage
\section{Competitive Equilibrium in a Pure Exchange\\ Economy}

\subsection{The Economy}
There are $I$ agents, and the world is stochastic so that at time $t$
some state $s_t\in S$ will be realized. State histories are denoted
$s^t:=\{s_0,\ldots,s_t\}$
which occurs with probability $\pi_t(s^t)$.
\begin{enumerate}
  \item \emph{Endowments}: Each agent has a state-contingent endowment
    $\{y^i_t(s^t)\}\tinfz$.

    The $y_t^i(s^t)$ are measurable functions from a state history to a
    endowment realization.  In particular, if state history $s^t$ has
    been realized at time $t$, the endowment is $y_t^i(s^t)$.
  \item \emph{Preferences}:
    Each household chooses a state-contingent consumption plan
    $c^i := \{c_t^i(s^t)\}\tinfz$, i.e. a sequence of functions (one for
    each $t$) mapping from the state history realization $s^t$ into
    consumption.
    Preferences over consumption streams given by
    \begin{align}
      U(c^i) :=
      \E_0\left[
      \sumtinfz \beta^t
        u(c_t^i)
      \right]
      =
      \sumtinfz
        \sum_{s^t}
        \beta^t
        u\left(c_t^i(s^t)\right)\pi_t(s^t)
      \label{ad:objfcn}
    \end{align}
  \item \emph{Technology}:
    Pure exchange economy, so no production. Instead, agents trade
    time- and state history- contingent claims to their endowments to
    build their preferred consumption sequence.
    But for any such $t$ and $s^t$, total consumption must be feasible
    \begin{align*}
      \sum_i c_t^i(s^t) \leq \sum_i y_t^i(s^t)
      \qquad \forall t,s^t
    \end{align*}
    In words, at any time $t$ and state history realization $s^t$,
    consumption is financed purely from endowments/wealth, so total
    consumption cannot exceed total wealth at that $t$ and $s^t$
    combination.

    We let $p_t^\tau(s^t)$ represent the price of such a claim. This is
    the price of an asset that pays one unit of the consumption good
    $c_t$ at time $t$ if state history $s^t$ is realized.
    Its price is quoted in terms/units of the time $\tau$ consumption
    good $c_\tau$.

    In other words, to buy this asset, you must give up or sell a claim
    to $p_t^\tau(s^t)$ units of $c_\tau$. Then, if state history $s^t$
    is realized at $t$, you'll be compensated with enough money at time
    $t$ to go out and buy one unit of $c_t$.
\end{enumerate}

\clearpage
\subsection{Arrow-Debreu Competitive Equilibrium: Time 0 Trading}

\begin{itemize}
  \item
    At time $t=0$, you can buy and sell a security with price
    $p_t^0(s^t)$ (in some arbitrary units to be discussed later) that
    pays one unit of consumption at time $t$ if state history $s^t$ is
    realized.
    The household can therefore sell claims to its endowment
    realizations at these prices and then buy a bundle of these
    securities to construct its desired consumption plan $c^i$. This
    leads to the \emph{single} budget constraint for agent $i$
    \begin{align}
      \sumtinfz \sum_{s^t} p^0_t(s^t)c^i_t(s^t)
      \leq
      \sumtinfz \sum_{s^t} p^0_t(s^t)y^i_t(s^t)
      \label{ad:budget}
    \end{align}
    Note that this budget constraint is not in expectation or anything.
    It is exact/deterministic. We sum over every time period $t$ and
    every unique history $s^t$ \emph{within} a time period because
    contingent claim securities exist for every time and state-history
    combination.

  \item \emph{Household Optimization}:
    Household $i$ is trying to maximize expected utility in
    Expression~\ref{ad:objfcn} subject to the budget constraint in
    Expression~\ref{ad:budget}.  This gives the following time-$t$,
    state-history $s^t$ first order condition for agent $i$:
    \begin{align}
      \beta^t u'\left(c_t^i(s^t)\right) \pi_t(s^t)
      &= \mu_i p_t^0(s^t)
      \label{ad:foc}
    \end{align}
    where we took the derivative with respect to $c_t^i(s^t)$ and
    $\mu_i$ is the agent $i$ multiplier.

    To summarize allocations across individuals, divide first order
    condition Expression~\ref{ad:foc} for agent $i$ by the one for agent
    $j$:
    \begin{align}
      \frac{u'\left(c_t^i(s^t)\right)}{u'\left(c_t^j(s^t)\right)}
      &= \frac{\mu_i}{\mu_j}
      \label{ad:ratio}
    \end{align}
    Since the multipliers $\mu_i$ and $\mu_j$ are time-invariant for
    each agent, the ratio of marginal utilities is constant at
    \emph{every} time $t$ and for \emph{any} state realization $s^t$.

    Choosing $j=1$, we can solve Expression~\ref{ad:ratio} for agent
    $i$'s consumption:
    \begin{align}
      c_t^i(s^t)
      &=
      u'^{-1}
      \left[
      u'\left(c_t^1(s^t)\right)
      \frac{\mu_i}{\mu_1}
      \right]
    \end{align}
    Summing over all individuals and using market clearing
    \begin{align*}
      \sum_i y_t^i(s^t)
      =
      \sum_i c_t^i(s^t)
      =
      \sum_i
      u'^{-1}
      \left[
      u'\left(c_t^1(s^t)\right)
      \frac{\mu_i}{\mu_1}
      \right]
    \end{align*}
    where the first object in the equality is the realization of the
    aggregate endowment. From this, we also conclude that $c^1_t(s^t)$
    in the rightmost expression (the only choice variable slash
    non-parameter) depends on $s^t$ only through the realization of the
    aggregate endowment $\sum_i y_t^i(s^t)$ and the ratios $\mu_i/\mu_1$
    (which are just parameters). From there, you can conclude the same
    for any $c^i_t(s^t)$, not just $i=1$, by using
    Expression~\ref{ad:ratio}.

    Therefore, conclude that
    \begin{align*}
      s^t, \tilde{s}^\tau
      \quad\text{s.t.}\quad
      \sum_i y_t^i(s^t)
      = \sum_i y_\tau^i(\tilde{s}^\tau)
      \quad\implies\quad
      c_t^i(s^t) = c_\tau^i(\tilde{s}^\tau)
      \qquad \forall i
    \end{align*}
    That is, even for compeletely different times $t\neq \tau$, if the
    state histories $s^t$, $\tilde{s}^\tau$ are such that aggregate
    endowments have the same realized value at those times, consumption
    will be \emph{the same} for \emph{all agents}.  Only the aggregate
    endowment and parameters $\mu_i$ matter for an agent's consumption
    at a particular time---not how you got to that aggregate endowment
    or when you got to that aggregate endowment.

  \item \emph{Prices}:
    Note that we typically normalize prices so that $p_0^0(s_0)=1$,
    which puts all prices in units of time zero goods.
\end{itemize}

\subsection{Preview}

If we disallow trades, it's clear that the household $i$'s consumption
at time $t$, denoted $c_t^i$, depends directly upon the realization
$s^t$, the full-history state realization. In particular, his
consumption is equal to the realization of his endowment $y^i_t(s^t)$
(provided there are no bonds to transfer consumption across time), which
is directly a function of $s^t$.  Therefore, consumption, more
explicitly denoted $c_t^i(s^t)$, is directly a function of full state
history $s^t$.

However, after allowing trades, the remarkable feature is
\begin{align*}
  s^t, \tilde{s}^\tau
  \quad\text{s.t.}\quad
  \sum_i y_t^i(s^t)
  = \sum_i y_\tau^i(\tilde{s}^\tau)
  \quad\implies\quad
  c_t^i(s^t) = c_\tau^i(\tilde{s}^\tau)
  \qquad \forall i
\end{align*}
That is, even for compeletely different times $t\neq \tau$, if the state
histories $s^t$, $\tilde{s}^\tau$ are such that \emph{aggregate}
endowments have the same realized value at those times, consumption will
be \emph{the same} for \emph{all agents}.  Only the aggregate endowment,
some time-invariant parameters, and the initial wealth distribution
matter for consumption at any time and state history realization---not
how you got to that aggregate endowment, the cross section of individual
endowment realizations (i.e.\ we observe full insurance), or when you
got to that aggregate endowment.

\clearpage
\subsection{Asset Pricing}

Let $\{d_t(s^t)\}\tinfz$ denote an asset that pays $d_t(s^t)$ units of
the consumption good at time $t$ given state history $s^t$. In other
words, $d_t(\cdot)$ is a function that maps a state history up to $t$,
denoted $s^t$, into $d_t(s^t)$  units of the consumption good at that
time $t$. The asset is a bundle of such functions/contingent claims.

We can price this asset using the prices of contingent claims
\begin{align*}
  P_0^0(s_0)
  =
  \sumtinfz \sum_{s^t} p_t^0(s^t) \cdot d_t(s^t)
\end{align*}
This is the price at time $t=0$ in units of the $t=0$ consumption good.

We let $P^0_\tau$ denote the time-zero price that entitles the owner to
$\{d_t(s^t)\}_{t=\tau}^\infty$ (i.e.\ post-time-$\tau$ payments),
conditional on state $s^\tau$ being realized. It can be priced
\begin{align*}
  P_\tau^0(s^\tau)
  =
  \sumtinfz \sum_{s^t|s^\tau} p_t^0(s^t) \cdot d_t(s^t)
\end{align*}
So given original payment stream $\{d_t(s^t)\}\tinfz$, we strip out all
contingent claims for times $t=0,\ldots,\tau$ and \emph{also}
throw out all contingent claims that correspond to state histories
$\tilde{s}^t$ for $t\geq \tau$ such that $\tilde{s}^\tau \neq s^\tau$.
This is the price at time zero in units of the time-zero consumption
good of an asset that gets the owner all post-$\tau$ payments
$\{d_t(s^t)\}^\infty_{t=\tau}$ if state history $s^\tau$ is realized.

We can re-express this price in units of the time $\tau$ consumption
good (changing notation from $P^0_\tau$ to $P^\tau_\tau$) by computing
\begin{align*}
  P_\tau^\tau(s^\tau)
  =
  \frac{P_0^\tau(s^\tau)}{p_\tau^0(s^\tau)}
  =
  \sumtinfz \sum_{s^t|s^\tau} \frac{p_t^0(s^t)}{p_\tau(s^\tau)} \cdot d_t(s^t)
\end{align*}
This is the equity price you see quoted on the ticker. It is the price
quoted at time $\tau$, given partial history $s^\tau$ up to that time, and in
units of the time-$\tau$ consumption good. You get all dividends
thereafter. It's called the \emph{tail asset}.

\clearpage
\subsection{Sequence of Markets}

Let $\tilde{a}^i_t(s^t)$ represent a contingent claim that pays one unit
of time-$t$ consumption in time $t$ if state history $s^t$ is realized.
\begin{enumerate}
  \item \emph{Sequence of Budget Constraints}:
    We are at some time $t\geq 0$. The state history $s^t$ has been
    realized. The budget constraint is
    \begin{align*}
      \tilde{c}_t^i(s^t)
      + \sum_{s_{t+1}}
      \tilde{a}^i_{t+1}(s_{t+1},s^t)
      \tilde{Q}_t(s_{t+1}|s^t)
      \leq y^i_t(s^t) + \tilde{a}_t^i(s^t)
    \end{align*}
    On the RHS are the total assets agent $i$ has at time $t$. Those
    include the endowment realization $y^i_t(s^t)$ and the claims
    purchased at time $t-1$ that pay units of consumption in this state,
    denoted $\tilde{a}_t^i(s^t)$.

    Given those assets, the agent spends them (as we see on the LHS) on
    current-period consumption $\tilde{c}_t^i(s^t)$ and on contingent
    claims for all possible realizations of tomorrow's state, which is
    captured by the sum over the $\tilde{a}^i_{t+1}(s_{t+1},s^t)$ terms
    that each represent the total payoff to the agent if state $s_{t+1}$
    is realized tomorrow.\footnote{%
      Alternatively, we can think of $\tilde{a}^i_{t+1}(s_{t+1},s^t)$ as
      a real number representing the total number of contingent claims
      purchased which pay up if $s_{t+1}$ is realized tomorrow.
    }
    Sincce the agent is buying and selling the one-period contingent
    claims denoted $\tilde{a}^i_{t+1}(s_{t+1},s^t)$, those values could
    be positive or negative (negative indicates borrowing-on/selling
    future consumption). So to rule out Ponzi schemes, we impose an
    additional constraint
    \begin{align*}
      -\tilde{a}^i_{t+1}(s^{t+1}) \leq
      A^i_{t+1}(s^{t+1})
      :=
      \sum^\infty_{\vphantom{s^\tau|s^{t+1}}\tau = t+1} \sum_{s^\tau|s^{t+1}}
      p^{t+1}_\tau (s^\tau)y_\tau^i(s^\tau)
    \end{align*}
    where $A^i_{t+1}(s^{t+1})$ is the natural debt limit for time $t+1$
    and history $s^{t+1}$.
    It's the value of the tail of agent $i$'s endowment sequence
    conditional on history $s^{t+1}$.
    %That is, if state $s_{t+1}$ is drawn tomorrow to give full state
    %history $s^{t+1}=(s^t,s_{t+1})$, the agent can sell off the right
    %to all future endowments $y_\tau^i(s^\tau)$ conditional on state
    %history $s^{t+1}|s^\tau$.

    Contigent claims prices are given by the pricing kernel
    $\tilde{Q}_t(s_{t+1}|s^t)$, which is the price today at time $t$ of
    a contingent claim that pays one unit of time-$t+1$ consumption at
    time $t+1$ if state $s_{t+1}$ is realized.
\end{enumerate}


\clearpage
\section{Savings Problem}

\subsection{Determistic Problem}

Consumption streams ordered by
\begin{align*}
  U\big(\{c_t\}\tinfz\big)
  = \sumtinfz \beta^tu(c_t)
\end{align*}
Possible ways to write the budget constraint:
\begin{itemize}
  \item
    \emph{Asset Holdings in Units of Time $t$ Consumption}:
    \begin{align*}
      c_t + a_{t+1} = Ra_t + y_t
    \end{align*}
    No-borrowing constraint expressed as
    \begin{align*}
      a_{t+1} \geq 0
    \end{align*}

  \item
    \emph{Asset Holdings in Units of Time $t+1$ Consumption}:
    \begin{align*}
      c_t + R^{-1}a_{t+1} = a_t + y_t
    \end{align*}
    No-borrowing constraint expressed as
    \begin{align*}
      a_{t+1} \geq 0
    \end{align*}

  \item \emph{Total Assets}:
    \begin{align*}
      a_{t+1} = R(a_t-c_t) + y_{t+1}
    \end{align*}
    No-borrowing constraint expressed as
    \begin{align*}
      c_t \leq a_t
    \end{align*}


\end{itemize}


\clearpage
\section{New Keynesian Model}

\subsection{Household Problem: Cashless Economy}

Households take wages $W_t$, prices of a zero-coupon discount bound
$Q_t$, prices $P_t$, profits/dividends from firms $D_t$, and preference
shifter $Z_t$ as given, and choose consumption $C_t$, hours $N_t$, and
bounds $B_t$
\begin{align*}
  \max_{\{C_t,N_t,B_t\}\tinfz} \;
  &\E_0\sumtinfz \beta^t U(C_t,N_t;Z_t) \\
  \text{s.t.}\quad&
  P_tC_t + Q_{t}B_t \leq B_{t-1} + W_tN_t + D_t\quad \forall t\\
  &\limT \E_t\bigg[
    \underbrace{\beta^{T-t} \frac{U_{c,T}}{U_{c,t}}}_{\Lambda_{t,T}}
    \frac{B_T}{P_T}
  \bigg]
  \geq 0
  \qquad \forall t
\end{align*}
where the second constraint is a no-Ponzi condition and
we define $U_t:=U(C_t,N_t;Z_t)$, partial derivatives
$U_{x,t}=\partial U_t/\partial X_t$, and stochastic discount factor
$\Lambda_{t,T}$ between $t$ and $T$.
First order conditions:
\begin{alignat*}{3}
  C_t:&&\quad
  \beta^t U_{c,t} &= \mu_t P_t
  \\
  N_t:&&\quad
  \beta^t U_{n,t} &= -\mu_t W_t
  \\
  B_t:&&\quad
  \mu_t Q_t &= \mu_{t+1}
\end{alignat*}
Divide the FOCs for $C_t$ and $N_t$ by each other, and use the FOC for
$B_t$ to link the $C_t$ and $C_{t+1}$ FOC. This gives optimality
conditions:
\begin{align*}
  Q_t &=
  \beta\;
  \E_t\left[
    \frac{U_{c,t+1}}{U_{c,t}}
    \frac{P_t}{P_{t+1}}
  \right]
  \\
  -\frac{U_{n,t}}{U_{c,t}}
  &=
  \frac{W_t}{P_{t}} \\
  0 &=
  \limT \E_t\bigg[
    \Lambda_{t,T}
    \frac{B_T}{P_T}
  \bigg]
\end{align*}
where the third equation is a TVC. It must hold because if the no-Ponzi
condition held with strict inequality, the consumer could raise
utility by a discrete amount without decreasing future consumption, and
that would violate optimality. So the TVC must hold for an optimal
sequence.

\clearpage
\subsection{Household Problem: Money in the Utility Function}

Households solve
\begin{align*}
  \max_{\{C_t,N_t,B_t,M_t\}\tinfz} \;
  &\E_0\sumtinfz \beta^t U(C_t,M_t/P_t,N_t;Z_t) \\
  \text{s.t.}\quad&
  P_tC_t + Q_{t}B_t + M_t
  \leq B_{t-1} + M_{t-1} + W_tN_t + D_t\quad \forall t\\
  &\limT \E_t\bigg[
    \underbrace{\beta^{T-t} \frac{U_{c,T}}{U_{c,t}}}_{\Lambda_{t,T}}
    \frac{B_T+M_t}{P_T}
  \bigg]
  \geq 0
  \qquad \forall t
\end{align*}
Alternatively, we define cash-on-hand $X_t=M_t+B_t$ and rewrite the
budget constraint as
\begin{align*}
  P_tC_t
  + Q_{t}X_t
  + (1-Q_{t})M_t
  \leq X_{t-1} + W_tN_t + D_t
\end{align*}
First order conditions:
\begin{alignat*}{3}
  C_t:&&\quad
  \beta^t U_{c,t} &= \mu_t P_t \\
  N_t:&&\quad
  \beta^t U_{n,t} &= -\mu_t W_t \\
  B_t:&&\quad
  \mu_t Q_t &= \mu_{t+1} \\
  M_t:&&\quad
  \beta^t \frac{U_{m/p,t}}{P_t}
  &=
  \mu_t - \mu_{t+1}
\end{alignat*}
These conditions yield
\begin{align*}
  Q_t &= \beta \E_t\left[
    \frac{U_{c,t+1}}{U_{c,t}}\frac{P_t}{P_{t+1}}
  \right]
  \\
  -\frac{U_{c,t}}{U_{n,t}} &= \frac{P_t}{W_t}
  \\
  \frac{U_{m/p,t}}{U_{c,t}}
  &=
  1 - Q_t
\end{align*}



\clearpage
\subsection{Firm Problem: Competitive Firm}


Firms choose labor/hours to maximize profits:
\begin{align*}
  \max_{N_t} \; &P_tY_t - W_tN_t \\
  \text{s.t.} \quad &Y_t =A_tN_t^{1-\alpha}
\end{align*}
The first order condition is
\begin{align*}
  \frac{W_t}{P_t} = (1-\alpha) A_t N_t^{-\alpha}
\end{align*}


\subsection{Firm Problem: Monopolistic Competition}

There are two sectors
\begin{enumerate}[label=(\roman*)]
  \item
    \emph{Final Good}:
    There is a representative firm in the final goods sector that uses
    intemediate goods $Y_t(i)$ for $i\in[0,1]$ to produce final good
    $Y_t$, which the household consumes.
    It combines the intermediate goods using a CES production function,
    taking prices of the intermediate goods $P_t(i)$ and the final good
    $P_t$ as given. Therefore, the firm solves
    \begin{align*}
      \max_{Y(i)} &\; P_tY_t - \intzo P_t(i)Y_t(i)\;di \\
      \text{s.t}\quad &
      Y_t = \left(
        \intzo Y_t(i)^{\frac{\varepsilon-1}{\varepsilon}}
        \; di
      \right)^{\frac{\varepsilon}{\varepsilon-1}}
    \end{align*}
    where $Y_t(i)$ is the quantity of intermediate good $i$ that is used
    in the production of $Y_t$. The result of this maximization problem
    is a demand function for intermediate good $Y_t(i)$ as a function of
    total output $Y_t$ and prices $P_t(i)$:
    \begin{align}
      Y_t(i) = Y_t\left(\frac{P_t(i)}{P_t}\right)^{-\varepsilon}
      \label{nkdemand}
    \end{align}
    where $\varepsilon$ is the elasticity of substitution between
    different intermediate goods. Since the firm faces competitive input
    and output markets, profits are zero.

  \item
    \emph{Intermediate Goods}:
    There is a continuum of monopolistically competitive intermediate
    goods firms, $i\in[0,1]$. Each $i$th firm uses a CRS production
    function, hiring labor $N_t(i)$ to produce output $Y_t(i)$ according
    to
    \begin{align*}
      Y_t(i) &= A_t N_t(i)
      \quad\implies\quad
      N_t(i) = \frac{Y_t(i)}{A_t}
      \\
      \ln A_t = a_t &= \rho_a a_{t-1} + \varepsilon_t^a
    \end{align*}
    where marginal productivity of labor $A_t$ is common to all firms
    and taken as given.  Each intermediate goods firms takes the demand
    curve for their firm/variety, Equation~\ref{nkdemand}, as given and
    chooses price (which determines quantity through the demand curve)
    to max profits. Their choice of price (taking the demand curve as
    given) depends on their ability to reset prices later on. Therefore,
    we consider a few cases.

    But first we define a few objects:
    \begin{align*}
      \text{Nom. Unit Labor Cost:}\qquad\qquad
      &\;\frac{W_t}{A_t}
      \\
      \text{Nom. Marginal Cost:}\quad
      M_t^n :=&\; \frac{W_t}{A_t}
      \\
      \text{Real. Marginal Cost:}\quad
      M_t :=&\;
      \frac{M_t^n}{P_t}
      =
      \frac{W_t}{P_tA_t}
      \\
      \text{Markup:}\quad\quad
      \mu:= &\;\frac{\varepsilon}{\varepsilon-1} > 1
    \end{align*}
    Nominal unit labor cost represents the nominal amount of money spent
    on \emph{labor} to produce one more unit of output. Nominal marginal
    cost is the nominal amount of money spent on \emph{all inputs} to
    produce one more unit of output. Since there is no capital in this
    economy (labor is the only input), nominal marginal cost simply
    equals unit labor cost. With more inputs, these objects would
    differ. Lastly, we'll see where the name markup comes from below.
    \begin{itemize}
      \item \emph{Flexible Prices}:
        Firms face a sequence of static problems in each period
        \begin{align*}
          \max_{P_t(i),Y_t(i),N_t(i)}
          \;&P_t(i)Y_t(i) - W_tN_t(i)
          \\
          \iff\qquad
          \max_{P_t(i)}
          \;&
          \underbrace{%
          \left(
          P_t(i)
          - \frac{W_t}{A_t}
          \right)
          }_{\text{Per-Unit Profit}}
          \underbrace{%
          Y_t\left(\frac{P_t(i)}{P_t}\right)^{-\varepsilon}
          }_{\text{Output, $Y_t(i)$}}
        \end{align*}

        First order conditions to the maximization problem:
        \begin{align*}
          P_t(i) =& \;\frac{\varepsilon}{\varepsilon-1}\frac{W_t}{A_t}
          = \mu M_t^n
        \end{align*}
        We see where the markup gets its name: it's the constant markup
        over nominal or real marginal cost $M_t^n$ that yields the
        nominal price $P_t(i)$ or the real price $P_t(i)/P_t$,
        respectively. It depends on the elasticity of demand, not on
        time. We could also put this in real terms:
        \begin{align*}
          \frac{P_t(i)}{P_t} &=
          \frac{\varepsilon}{\varepsilon-1}\frac{W_t}{A_tP_t}
          =
          \mu \frac{M_t^n}{P_t}
          =
          \mu M_t
        \end{align*}
        Since all firms identical, focus on symmetric equilibrium, which
        implies
        \begin{align*}
          P_t(i)=P_t
          \quad\implies\quad
          \mu M_t=1
          \quad\implies\quad
          M_t = 1/\mu
        \end{align*}

      \item \emph{Rottenburg Quadratic Price Adjustment Costs}: Now we
        consider the case where you can \emph{always} change your price,
        but at a cost that depends on the amount you change by.  This
        differs from \emph{menu costs}, where the \emph{size} of the
        price adjustment does not impact the \emph{cost} of changing
        prices. If you pay the fixed cost to change menus, you can
        change as much as you want---there's no marginal cost to larger
        changes.  Also, Rottenburg is state-dependent rather than
        time-dependent.

        So now we again solve the problem a firm choosing which price to
        set, except the problem is recursive (rather than a sequence of
        static problems). Therefore, we define the firms value function
        \begin{align*}
          v\big(P_{t-1}(i)\big) =
          \max_{P_t(i)}\;\;
          &
          Y_t\left(
          \frac{P_t(i)}{P_t}
          \right)^{-\varepsilon}
          \left(
          P_t(i)-M_t
          \right)
          - \frac{1}{2}\theta
          \left(
          \frac{P_{t}(i)}{P_{t-1}(i)}-1
          \right)^2
          P_tY_t \\
          &\qquad
          + \E_t\left[\Lambda_{t,t+1}\;v\big(P_t(i)\big)\right]
        \end{align*}
        where the first term is period profits as a function of prices,
        $\theta$ is a measure of price stickiness, and price adjustment
        costs are in terms of the cost of total final output.  We use
        the discount factor
        $\Lambda_{t,T}=\beta^{T-t}
        \frac{U_{c,T}}{U_{c,t}}\frac{P_t}{P_T}$---that's the ``correct''
        one---because firms are owned by households; therefore, firms
        should discount future profits at the same rate as households.

        First order condition on the RHS:
        \begin{align*}
          0 &=
          \left[
          1-\varepsilon
          \frac{P_t(i)-M_t}{P_t(i)}
          \right]
          Y_t\left(
          \frac{P_t(i)}{P_t}
          \right)^{-\varepsilon}
          - \theta
          \left(
          \frac{P_{t}(i)}{P_{t-1}(i)}-1
          \right)
          \frac{P_tY_t}{P_{t-1}(i)}
          + \E_t\left[\Lambda_{t,t+1}\;v'\big(P_t(i)\big)\right]
        \end{align*}
        Envelope condition:
        \begin{align*}
          v'\big(P_{t-1}(i)\big)
          &=
          \theta
          \left(
          \frac{P_{t}(i)}{P_{t-1}(i)}-1
          \right)
          \frac{P_{t}(i)}{P_{t-1}(i)^{2}}
          P_tY_t
        \end{align*}
        Next, since all firms are identical, we impose symmetry,
        $P_t(i)=P_t$, and define $\Pi_t=P_t/P_{t-1}$ to make our lives
        easier. Doing so simplies the FOC and envelope conditions to
        \begin{align*}
          0 &=
          (1-\varepsilon)Y_t + \varepsilon M_tY_t
          - \theta
          \left(
          \Pi_t-1
          \right)
          \Pi_tY_t
          + \E_t\left[\Lambda_{t,t+1}\;v'\big(P_t\big)\right]
          \\
          v'\big(P_{t-1}\big)
          &=
          \theta
          \left(
          \Pi_t-1
          \right)
          \Pi_t^2Y_t
        \end{align*}
        Substituting the envelope condition into the FOC and dividing
        through by $Y_t(\varepsilon-1)$, we get
        \begin{align*}
          0 &=
          -1 + \frac{\varepsilon}{\varepsilon-1} M_t
          - \frac{\theta}{\varepsilon-1}
          \left(
          \Pi_t-1
          \right)
          \Pi_t
          + \frac{\theta}{\varepsilon-1}
          \E_t\left[
            \Lambda_{t,t+1}\;
            (\Pi_{t+1}-1)\Pi^2_{t+1}\frac{Y_{t+1}}{Y_t}
          \right]
        \end{align*}
        We will log-linearize this below

  \end{itemize}
\end{enumerate}






\clearpage
\subsection{Log-Linearizing Optimality Conditions}


Some key assumptions and choices
\begin{enumerate}
  \item \emph{Utility, Cashless Economy}:
    We assume that period utility is separable in consumption and labor,
    with $Z_t$ a preference shifter that effectively changes the
    discount factor (it will only, therefore, affect intertemporal
    decisions, not intratemporal decisions). We use the form
    \begin{align*}
      U(C_t,N_t,Z_t) &=
      \left[
        \frac{C_t^{1-\sigma}-1}{1-\sigma}
        -
        \frac{N_t^{1+\varphi}}{1+\varphi}
      \right] Z_t
      \qquad \sigma,\varphi \geq 0 \\
      \text{where}\quad
      \ln Z_t :=
      z_t &= \rho_z z_{t-1} + \varepsilon_t^z
    \end{align*}
    where $\sigma,\varphi\geq 0$ ensures utility will be concave in
    consumption and convex in hours worked.
    This utility function has first derivatives
    \begin{align*}
      U_{n,t} &= -Z_t N_t^{\varphi} \\
      U_{c,t} &= Z_t C_t^{-\sigma}
    \end{align*}
    The parameter $\varphi$ is the inverse Frisch labor supply
    elasticity under our assumed functional form.

  \item \emph{Utility, Money in the Utility Function}:
    Consumers now also have preferences for real money balances:
    \begin{align*}
      U(C_t,M_t/P_t,N_t,Z_t) &=
      \left[
        \frac{C_t^{1-\sigma}-1}{1-\sigma}
        + \frac{(M_t/P_t)^{1-\nu}}{1-\nu}
        - \frac{N_t^{1+\varphi}}{1+\varphi}
      \right] Z_t
      \qquad \sigma,\nu,\varphi \geq 0
    \end{align*}
    where $\sigma,\nu,\varphi\geq 0$ ensures utility will be concave in
    consumption, concave in real money balances, and convex in hours
    worked. We add first derivative with respect to money:
    \begin{align*}
      U_{m/p,t} &= Z_t (M_t/P_t)^{-\nu}
    \end{align*}
    Since utility is separable, the other derivatives don't change.

  \item \emph{Logged Variables}:
    For any model object $X_t$, we define
    $x_t = \ln X_t$.

  \item \emph{New Variables}:
    Since $Q_t$ is the nominal price of the zero-coupon discount bound,
    define the nominal interest rate as $i_t = -\ln Q_t$. Also define
    $\rho$ as the discount rate implied by $\beta$ the discount factor:
    $\beta = e^{-\rho}$, and define inflation $\pi_t=\ln(P_{t+1}/P_t)$

  \item \emph{Taylor-Expansion Point}:
    To linearize non-linear functions, we will often employ a
    first-order Taylor-expansion
    \begin{align*}
      f(x_t) = f(x) + f'(x)(x_t-x)
    \end{align*}
    where $x_t$ represents sums and differences of several model
    objects. For a totally made-up example, we might have $f(y)=\exp(y)$
    and
    \begin{align*}
      x_t = \pi_t + i_t - \rho
    \end{align*}
    The point $x$ that we Taylor-expand about is the equivalent of
    $x_t$, but in a ``steady state'' that is non-stochastic ($\Delta
    z_t=0$), on a balanced growth path ($\Delta c_t =g$), and has zero
    inflation ($\pi_t=0$). So in the above example, that would
    $x=0+i-\rho$.

    Note that growth in consumption $\Delta c_t=g$ will come from growth
    in productivity, $A_t$, that we will see in the firm problem.
\end{enumerate}
We now log-linearize the varous optimality conditions:
\begin{itemize}
  \item Intratemporal Labor-Consumption Choice:
    \begin{align*}
      -\frac{U_{n,t}}{U_{c,t}}
      =
      \frac{W_t}{P_{t}}
      \quad\implies\quad
      w_t - p_t
      =
      \varphi n_t
      + \sigma c_t
    \end{align*}
    This is effectively the household's labor supply schedule given the
    real wage, $w_t-p_t$. It's even more clear here that $\varphi$ is
    the inverse Frisch labor supply elasticity, since we can see that
    $\varphi$ is the increase in labor supply $n_t$, holding $c_t$ (and
    hence marginal utility---since that only depends on $c_t$ given our
    assumed utility function) constant.

  \item Intertemporal Consumption Choice:
    We log-linearize in a sequence of steps
    \begin{enumerate}[label=(\roman*)]
      \item \emph{Substitute in the functional form}:
        \begin{align*}
          Q_t =
          \beta\;
          \E_t\left[
            \frac{U_{c,t+1}}{U_{c,t}}
            \frac{P_t}{P_{t+1}}
          \right]
          &=
          \beta\;
          \E_t\left[
            \frac{Z_{t+1}}{Z_{t}}
            \left(\frac{C_{t+1}}{C_t}\right)^{-\sigma}
            \frac{P_t}{P_{t+1}}
          \right] \\
          \iff\quad
          1 &=
          \E_t\left[
            \exp\left\{
            \ln
            \left(
            \frac{Z_{t+1}}{Z_{t}}
            \left(\frac{C_{t+1}}{C_t}\right)^{-\sigma}
            \frac{P_t}{P_{t+1}}
            \frac{\beta}{Q_t}
            \right)
            \right\}
          \right]
        \end{align*}

      \item \emph{Rewrite to Prepare for Log-Linearization}:
        Use the definitions of the logged variables to rewrite the RHS
        as
        \begin{align*}
          1
          =&\;
          \E_t\left[
            \exp\left\{
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            - \pi_{t+1}
            -\rho
            + i_t
            \right\}
          \right]\\
          =&\; \E_t[\exp\{x_t\}] \\
          \text{where} \quad
          x_{t+1} :=&\;
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            - \pi_{t+1}
            -\rho
            + i_t
        \end{align*}

      \item \emph{Taylor-Expansion}:
        We now want to log-linearize the exponential in the expectation
        operator so we can use linearity of expectations. The function is
        $f(y)=\exp(y)$, and the point we log-linearize aobut is the $x_t$ in
        the ``steady state'' defined above.
        \begin{align*}
          x :=&\; 0 - \sigma g - 0 - \rho + i
          = -\sigma g-\rho + i\\
          \implies\quad
          \exp\{x_t\}
          \approx&\;
          \exp\{x\} +
          \exp\{x\}
          \left[
            \big(
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            - \pi_{t+1}
            -\rho
            + i_t
            \big)
            - x
          \right]
        \end{align*}
        To simplify this a bit, consider what would happen if
        $x_t=x$---i.e.\ if the economy were in steady state. Then the
        optimality condition would say that
        \begin{align*}
          1 = E_t[\exp\{x\}] = \exp\{x\}
          \quad\iff\quad
          0 = x = -\sigma g -\rho +i
        \end{align*}
        Therefore, we can rewrite the Taylor expansion as
        \begin{align*}
          \exp\{x_t\}
          &\approx
          1 +
          \left[
            \big(
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            - \pi_{t+1}
            -\rho
            + i_t
            \big)
            - x
          \right] \\
          &=
          1 +
            \Delta z_{t+1}
            -\sigma (\Delta c_{t+1}-g)
            - \pi_{t+1}
            + (i_t -i) \\
          \text{Get rid of $i=\sigma g+\rho$}\quad
          &=
          1 +
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            + i_t
            - \pi_{t+1} -\rho
        \end{align*}

      \item
        \emph{Write Optimality Condition in Log-Linear Form}:
        Sub this last expression into the RHS of optimality
        condition above:
        \begin{align*}
          0
          =&\;
          \E_t\big[
            \Delta z_{t+1}
            -\sigma \Delta c_{t+1}
            - \pi_{t+1}
            -\rho + i_t
          \big]\\
          -\sigma c_{t}
          =&\;
          \E_t\big[
            (\rho_z z_t+\varepsilon^z_t) -z_{t}
            -\sigma c_{t+1}
            - \pi_{t+1}
            -\rho + i_t
          \big]\\
          c_{t}
          =&\;
          \E_t[c_{t+1}]
          -
          \frac{1}{\sigma}
          \big(
          \underbrace{%
          i_t-\E_t[\pi_{t+1}]
          }_{r_t}
          -\rho
          \big)
          +
          \frac{1}{\sigma}
          (1-\rho_z) z_t
        \end{align*}
        where $r_t=i_t-\E_t[\pi_t]$ is the expected real rate of return.
    \end{enumerate}
    Therefore, we end up with the consumption Euler equation:
    \begin{align*}
      c_{t}
      =&\;
      \E_t[c_{t+1}]
      -
      \frac{1}{\sigma}
      \big(
      \underbrace{%
      i_t-\E_t[\pi_{t+1}]
      }_{r_t}
      -\rho
      \big)
      +
      \frac{1}{\sigma}
      (1-\rho_z) z_t
    \end{align*}

  \item Money Demand:
    This is only relevant if we consider the money-in-utility economy
    \begin{align*}
      \frac{U_{m/p,t}}{U_{c,t}}
      =
      1 - Q_t
      \quad\iff\quad
      \frac{M_t}{P_t}
      &=
      C_t^{\sigma/\nu}(1 - Q_t)^{-1/\nu}
    \end{align*}
    We will log-linearize this by writing
    \begin{align*}
      \frac{M_t}{P_t}
      &=
      C_t^{\sigma/\nu}(1 - e^{-i_t})^{-1/\nu} \\
      m_t - p_t
      &=
      \frac{\sigma}{\nu}c_t
      -\frac{1}{\nu}\ln (1 - e^{-i_t})
    \end{align*}
    Now Taylor-Expand $\ln(1-e^{-i_t})$ about nonstochastic steady state
    value $i$:
    \begin{align*}
      \ln(1-e^{-i_t})\approx
      \ln(1-e^{-i})
      + \frac{e^{-i}}{1-e^{-i}}
      (i_t-i)
    \end{align*}
    Ignore the constant terms: the whole first term and the $f'(i)i$
    part of the second term; the total is just a constant. Though it
    will change the value of $m_t-p_t$, the ``mistake'' will be constant
    across time and values of $m_t-p_t$, so we will just have to change
    our interpretation of $m_t$. Therefore, the log linear equation is
    \begin{align*}
      m_t - p_t
      &\approx
      \frac{\sigma}{\nu}c_t
      - \frac{1}{\nu(e^{i}-1)}
      i_t \\
      &\approx
      \frac{\sigma}{\nu}c_t
      - \frac{1}{\nu i} i_t \\
      \iff
      m_t - p_t
      &=
      \frac{\sigma}{\nu}c_t
      - \eta i_t
    \end{align*}
    where $\eta=1/(\nu i)$ is the semi interest elasticity of money
    demand.


  \item Production: We have
    \begin{align*}
      Y_t = A_t N_t^{1-\alpha}
      \quad\implies\quad
      y_t = a_t + (1-\alpha)n_t
    \end{align*}

  \item Firm Problem: Recall that we have
    \begin{align*}
      \frac{W_t}{P_t} = (1-\alpha)A_t N_t^{-\alpha}
      \quad\implies\quad
      w_t - p_t
      = \ln(1-\alpha) + a_t - \alpha n_t
    \end{align*}
    We assume that
    \begin{align*}
      \ln A_t = a_t = \rho_a a_{t-1} + \varepsilon_t^a
    \end{align*}

  \item
    \emph{Inflation under Rottenburg Pricing}:
    We want to log-linearize the first order optimality condition:
    \begin{align*}
      0 &=
      \underbrace{%
      -1 + \frac{\varepsilon}{\varepsilon-1} M_t
      }_{(i)}
      -
      \frac{\theta}{\varepsilon-1}
      \underbrace{%
      \left(
      \Pi_t-1
      \right)
      \Pi_t
      }_{(ii)}
      +
      \frac{\theta}{\varepsilon-1}
      \E_t\bigg[
      \underbrace{%
        \Lambda_{t,t+1}\;
        (\Pi_{t+1}-1)\Pi^2_{t+1}\frac{Y_{t+1}}{Y_t}
      }_{(iii)}
      \bigg]
    \end{align*}
    We go term by term. First
    \begin{enumerate}[label=(\roman*)]
      \item Recall the definition of the markup
        $\mu=\frac{\varepsilon}{\varepsilon-1}$ and that the flexible
        price marginal cost is $1/\mu$. Therefore, for $M_t$ close to
        $1/\mu$, we can approximate
        \begin{align*}
          -1 + \frac{\varepsilon}{\varepsilon-1} M_t
          \approx \ln\left(\frac{\varepsilon}{\varepsilon-1} M_t\right)
          = m_t - \mu =: \tilde{m}_t
        \end{align*}

      \item Next, we linearize the function
        \begin{align*}
          F(\Pi_t) = (\Pi_t-1)\Pi_t
        \end{align*}
        about the zero-inflation steady state $\Pi=1$ up to a first
        order approximation:
        \begin{align*}
          F(\Pi_t)
          &\approx F(\Pi) + F'(\Pi)(\Pi_t-\Pi)
          \\
          &= \Pi + (2\Pi-1)(\Pi_t-\Pi)
          \\
          \text{$\Pi=1$}\implies\qquad
          &= \Pi_t-1
        \end{align*}
        For $\Pi_t$ close to one, we can approximate this by
        \begin{align*}
          (\Pi_t-1)\Pi_t
          \approx \Pi_t-1 \approx \log(\Pi_t) = \pi_t
        \end{align*}

      \item
        To log-linearize (iii)
        \begin{align*}
          (iii)
          =
          \Lambda_{t,t+1}\;
          (\Pi_{t+1}-1)\Pi^2_{t+1}\frac{Y_{t+1}}{Y_t}
        \end{align*}
        we need to make an assumption on the utility function, whose
        derivatives enter into the stochastic discount factor. We assume
        separable power utility, which gives (with market clearing
        $C_t=Y_t$)
        \begin{align*}
          (iii)
          &=
          \bigg[
          \underbrace{%
          \beta\left(\frac{Y_{t+1}}{Y_t}\right)^{-\sigma}
          \Pi_{t+1}^{-1}
          \frac{Z_{t+1}}{Z_t}
          }_{\Lambda_{t,t+1}}
          \bigg]
          (\Pi_{t+1}-1)\Pi^2_{t+1}\frac{Y_{t+1}}{Y_t}
          \\
          &=
          \beta\left(\frac{Y_{t+1}}{Y_t}\right)^{1-\sigma}
          \frac{Z_{t+1}}{Z_t}
          (\Pi_{t+1}-1)\Pi_{t+1} \\
          &=
          \beta
          \left[
          \left(\frac{Y_{t+1}}{Y_t}\right)^{1-\sigma}
          \frac{Z_{t+1}}{Z_t}
          \Pi_{t+1}^2
          -
          \left(\frac{Y_{t+1}}{Y_t}\right)^{1-\sigma}
          \frac{Z_{t+1}}{Z_t}
          \Pi_{t+1}
          \right]
          \\
          &=
          \beta
          \bigg[
          \exp\big\{
          (1-\sigma)\Delta y_{t+1}
          + \Delta z_{t+1}
          + 2\pi_{t+1}
          \big\}
          -
          \exp\big\{
          (1-\sigma)\Delta y_{t+1}
          + \Delta z_{t+1}
          + \pi_{t+1}
          \big\}
          \bigg]
        \end{align*}
        Now we will linearize the functions in brackets, which can be
        written as
        \begin{align*}
          F(\Delta y_{t+1}, \Delta z_{t+1}, \pi_{t+1})
          &\approx
          \exp\big\{
          (1-\sigma)\Delta y_{t+1}
          + \Delta z_{t+1}
          + k\pi_{t+1}
          \big\}
        \end{align*}
        We will now do a first-order Taylor expansion of $F$ about the
        nonstochastic ($\Delta z_{t+1}=0$), zero inflation
        ($\pi_{t+1}=0)$, balanced growth ($\Delta y_{t+1}=g_y$) steady
        state:
        \begin{align*}
          F(\Delta y_{t+1}, \Delta z_{t+1}, \pi_{t+1})
          &\approx
          F(g_y,0,0)
          + F_y(g_y,0,0)(\Delta y_{t+1}-g_y)
          \\
          &\qquad
          + F_z(g_y,0,0)(\Delta z_{t+1}-0)
          + F_\pi(g_y,0,0)(\pi_{t+1}-0)
          \\
          &= e^{(1-\sigma)g_y}
          \left[
            1+(1-\sigma)(\Delta y_{t+1}-g_y)
            + \Delta z_{t+1}
            + k\pi_{t+1}
          \right]
        \end{align*}
        Therefore, (iii) can be written in log-linear form as
        \begin{align*}
          (iii) \approx
          \beta e^{(1-\sigma)g_y}\pi_{t+1}
        \end{align*}
    \end{enumerate}
    Putting everything together, the log-linear first order condition is
    \begin{align*}
      0 &=
      (m_t-\mu)
      - \frac{\theta}{\varepsilon-1} \pi_t
      + \frac{\theta}{\varepsilon-1}\tilde{\beta}\E_t[\pi_{t+1}]
      \qquad \tilde{\beta} := \beta e^{(1-\sigma)g_y}
    \end{align*}
    This is a first order linear difference equation in $\pi_t$, which
    we can solve forward to get
    \begin{align*}
       \pi_t
      %&=
      %\frac{\varepsilon-1}{\theta}(m_t-\mu)
      %+\tilde{\beta}\E_t[\pi_{t+1}] \\
      &=
      \frac{\varepsilon-1}{\theta}
      \sum_{k=0} \tilde{\beta}^k
      \E_t[\tilde{m}_{t+k}]
      \qquad\text{where}\quad
      \tilde{m}_{t+k} = m_{t+k}-\mu
    \end{align*}
    We get
    \begin{align*}
      \pi_t &= \tilde{\beta}\;\E_t\pi_{t+1} + \lambda \tilde{m}_t
      \\
      \text{where}\quad
      \tilde{\beta} &=
        \beta e^{(1-\sigma)g_y} \\
      \lambda &=
        \frac{\varepsilon-1}{\theta}
    \end{align*}

\end{itemize}


\clearpage
\subsection{Equilibrium}

For given $\{z_t,a_t\}$, an equilibrium is an allocation
$\{c_t,n_t,y_t\}$ and prices $\{i_t,w_t,p_t\}$ such that
\begin{alignat*}{3}
  \text{Household Optimization}:&&
  \qquad\qquad
      c_{t}
      &=
      \E_t[c_{t+1}]
      -
      \frac{1}{\sigma}
      \big(
      \underbrace{%
      i_t-\E_t[\pi_{t+1}]
      }_{r_t}
      -\rho
      \big)
      +
      \frac{1}{\sigma}
      (1-\rho_z) z_t
      \\
      &&
      \omega_t:=
      w_t - p_t
      &=
      \varphi n_t
      + \sigma c_t
      \\
  \text{Firm Optimality}:&&\quad
      \omega_t:=w_t - p_t &= a_t - \alpha n_t + \ln(1-\alpha)
      \\
  \text{Market Clearing}:&&
    y_t &= c_t \\
    && y_t &= a_t + (1-\alpha)n_t
\end{alignat*}
Since $w_t$ and $p_t$ always enter together, only the real wage
$\omega_t:=w_t-p_t$ can be identified. But notice that the last four
equations pin down the four real endogenous variables in the economy
$\{y_t,n_t,c_t,\omega_t\}$. As a result, they also pin down the
\emph{real} interest rate by the \emph{first} equation, the consumption
Euler Equation:
\begin{align*}
    \underbrace{%
    i_t-\E_t[\pi_{t+1}]
    }_{r_t}
    &=
    \rho
    + \sigma \E_t[\Delta c_{t+1}]
    + (1-\rho_z) z_t
\end{align*}
In the nonstochastic economy, notice that we would have $r_t=\rho$ for
all $t$.

The only things not pinned down are nominal variables
$\{i_t,\E_t\pi_{t+1},w_t,p_t\}$. For that we specify monetary policy.
Notice that monetary policy won't have any \emph{real} effects (which is
why we need to introduce sticky prices later on). It simply pins down
nominal variables.


\subsection{Monetary Policy through Interest Rate Rules}

Recall that the real interest rate is pinned down by the real side of
the economy, while the monetary authority sets the nominal interest rate
$i_t$. Then, given $r_t$ and $i_t$, expected inflation $\E_t\pi_{t+1}$
responds endogenously through the Fisher equation, which was implicit in
the definition of the real interest rate:
\begin{align*}
  i_t = r_t + \E_t\pi_{t+1}
  \quad\implies\quad
  \E_t\pi_{t+1} = i_t - r_t
\end{align*}
In the nonstochastic steady state
\begin{align*}
  i = \pi + r = \pi + \rho
  \quad\iff\quad
  \pi = i - r = i - \rho
\end{align*}
We consider different rules:
\begin{itemize}
  \item \emph{Exogenous Nominal Interest Rate Path}: Suppose that the
    nominal interest rate is set
    \begin{align*}
      i_t &= i + \nu_t
      \\
      \nu_t &= \rho_\nu \nu_{t-1}+\varepsilon_t^\nu
    \end{align*}
    where $\nu_t$ is a monetary policy shock. Then, the path of
    $\E_t\pi_{t+1}$ can be summarized as
    \begin{align*}
      \E_t\pi_{t+1} &= i_t - r_t
      \\
      &= i + \nu_t - r_t \\
      &= \pi - (r_t-\rho) + \nu_t \\
      \iff\quad
      \pi_{t+1}
      &= \pi - \hat{r}_t + \nu_t  + \xi_{t+1}
      \qquad \E[\xi_{t+1}]=0
    \end{align*}
    where $\hat{r}_t:=r_t-\rho$ and where $\xi_{t+1}$ are ``sunspot''
    shocks. As we see, only \emph{expected} inflation is pinned down by
    the real economy and the interest rate rule; \emph{actual} inflation
    is not pinned down. In words, we have inflation indeterminacy, hence
    price indeterminacy, hence indeterminacy of all nominal variables.
    Given exogenous monetary shocks $\{\nu_t\}$, \emph{any} path of
    shocks $\{\xi_t\}$ that satisfy $\E_t[\xi_{t+1}]=0$ and the above
    inflation equation will constitute an equilibrium.
    This indeterminacy follows because the monetary rule was chosen
    \emph{independently} of the real side of the economy. If we change
    that, there will not be indeterminacy, as we see for the next rule.

  \item
    \emph{Simple Taylor Rule}:
    Suppose that the Fed sets nominal interest rates according to
    \begin{align*}
      i_t &= i + \phi_\pi(\pi_t-\pi) + \nu_t
      \qquad \phi_\pi > 0
      \\
      &= \rho + \pi + \phi_\pi(\pi_t-\pi) + \nu_t
    \end{align*}
    Then, expected inflation responds endogenously through the Fisher
    equation:
    \begin{align*}
      E_t\pi_{t+1} &=
      i_t - r_t
      \\
      &=
      \pi + \rho + \phi_\pi(\pi_t-\pi) + \nu_t - r_t
      \\
      E_t\pi_{t+1} -\pi
      &= \phi_\pi(\pi_t-\pi) - (r_t -\rho) + \nu_t \\
      E_t\hat{\pi}_{t+1}
      &= \phi_\pi\hat{\pi}_t - \hat{r}_t + \nu_t
    \end{align*}
    Again, $\hat{r}_t$ comes from the real side of the economy, while
    the monetary shock $\{\nu_t\}$ is exogenously given. If we ask about
    inflation at $t$, there are a few possibilities
    \begin{enumerate}[label=(\roman*)]
      \item $\phi_\pi>1$: We can solve forward the expected inflation
        equation to get
        \begin{align*}
          \hat{\pi}_t
          &=
          \phi_\pi^{-1}
          \big(
          E_t\hat{\pi}_{t+1} + \hat{r}_t - \nu_t
          \big) \\
          &=
          \sum_{k=0}^\infty
          \phi_\pi^{-k-1}
          \E_t[\hat{r}_{t+k}-\nu_{t+k}]
        \end{align*}
        This converges since $\phi_\pi>1$, so we can solve for the
        \emph{unique} nonexplosive equilibrium inflation path
        $\{\pi_t\}$, which imply unique paths for all other nominal
        variables.

      \item $\phi_\pi\in[0,1]$: Here, forward solution does not
        converge. Therefore, we have
        \begin{align*}
          E_t\hat{\pi}_{t+1}
          &= \phi_\pi\hat{\pi}_t - \hat{r}_t + \nu_t \\
          \hat{\pi}_{t+1}
          &= \phi_\pi\hat{\pi}_t - \hat{r}_t + \nu_t + \xi_{t+1}
          \qquad\E_t[\xi_{t+1}]=0
        \end{align*}
        Again, we have inflation indeterminacy. Any path of sunspot
        shocks $\{\xi_t\}$ that satisfy the above equation will do.
    \end{enumerate}
    That we must have $\phi_\pi>1$ for a determinite solution is called
    the \emph{Taylor Principle}.
\end{itemize}


\subsection{Monetary Policy through a Money Supply Rule}

We consider the economy with money in the utility function. The central
bank sets the money supply $\{m_t\}$ over time. We now compute the
prices that result. Return to money demand:
\begin{align*}
  m_t - p_t
  &=
  \frac{\sigma}{\nu}c_t
  - \eta i_t \\
  \iff\quad
  p_t
  &=
  m_t
  - \frac{\sigma}{\nu}c_t
  + \eta i_t
\end{align*}
No substitute the fisher equation in for $i_t$:
\begin{align*}
  p_t &=
  m_t
  - \frac{\sigma}{\nu}c_t
  + \eta \big(\E_t[\pi_{t+1}] + r_t\big)
  \\
  \iff\quad
  p_t
  &=
  m_t
  - \frac{\sigma}{\nu}c_t
  + \eta \big(\E_t[p_{t+1}] - p_t + r_t\big)
\end{align*}
We can rearrange to get
\begin{align*}
  \E_t[p_{t+1}]
  &=
  \left(
  1+
  \frac{1}{\eta}
  \right)p_t
  -
  \frac{m_t}{\eta}
  + \frac{\sigma}{\eta\nu}c_t
  - r_t
\end{align*}
We can solve this forward for prices. Note that there will be a unique
nonexplosive solution if and only if
\begin{align*}
  1+1/\eta>1
  \quad\iff\quad
  1/\eta>0
  \quad\iff\quad
  \nu > 0
\end{align*}
i.e.\ if utility is concave (not linear) in real money balances.

\clearpage
\subsection{New Keynesian Phillips Curve}

We can combine various conditions to arrive at the
\emph{New Keynesian Phillips Curve} which relates inflation to the
output gap and marginal costs. So start with the definition
\begin{align*}
  M_t
  &= \frac{W_t}{P_tA_t} \\
  \text{Household FOCs}\qquad
  &= \frac{C_t^\sigma N_t^\varphi}{A_t}
  \\
  \text{Market Clearing, then $Y_t=A_tN_t$}\qquad
  &= \frac{Y_t^\sigma N_t^\varphi}{A_t}
  =
  \frac{Y_t^\sigma}{A_t}
  \left(
  \frac{Y_t}{A_t}
  \right)^\varphi \\
  \implies\quad
  M_t &= Y_t^{\sigma+\varphi}A_t^{-(\varphi+1)}
\end{align*}
Expressed in log deviations from the flexible price counterpart
\begin{align*}
  \tilde{m}_t
  &=
  \big[(\sigma+\varphi)y_t-(1+\varphi)a_t\big]
  -
  \big[(\sigma+\varphi)y^n_t-(1+\varphi)a_t\big]
  \\
  &=
  \left(\sigma+\varphi\right)
  \tilde{y}_t
\end{align*}
Therefore, returning to inflation under Rottenburg pricing:
\begin{align*}
  \pi_t &= \tilde{\beta}\;\E_t\pi_{t+1} + \kappa \tilde{m}_t \\
  \text{where}\quad
  \tilde{\beta} &=
    \beta e^{(1-\sigma)g_y} \\
  \kappa &=
    \frac{(\varepsilon-1)(\sigma+\varphi)}{\theta}
\end{align*}


\subsection{New Keynesian Phillips Curve}

Next, we use market clearing to rewrite the consumption Euler equation
as
\begin{align*}
  y_t = \E_ty_{t+1}
  - \frac{1}{\sigma}(r_t-\rho)
  + \frac{1}{\sigma}(1-\rho_z)z_t
\end{align*}
In deviations from the flex-price counterpart:
\begin{align*}
  \tilde{y}_t
  = \E_t\tilde{y}_{t+1}
  - \frac{1}{\sigma}\tilde{r}_t
\end{align*}
If price rigidities vanish as $t\ra\infty$ so that
$\lim_{k\ra\infty}\tilde{y}_{t+k}=0$ sufficient fast, then we solve
the above equation forward to get
\begin{align*}
  \tilde{y}_t
  =
  - \frac{1}{\sigma}
  \sum_{k=0}^\infty \E_t[\tilde{r}_{t+k}]
\end{align*}









%% APPPENDIX %%

% \appendix




\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% SAMPLE CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    %% VIEW LAYOUT %%

        \layout

    %% LANDSCAPE PAGE %%

        \begin{landscape}
        \end{landscape}

    %% BIBLIOGRAPHIES %%

        \cite{LabelInSourcesFile}  %Use in text; cites
        \citep{LabelInSourcesFile} %Use in text; cites in parens

        \nocite{LabelInSourceFile} % Includes in refs w/o specific citation
        \bibliographystyle{apalike}  % Or some other style

        % To ditch the ``References'' header
        \begingroup
        \renewcommand{\section}[2]{}
        \endgroup

        \bibliography{sources} % where sources.bib has all the citation info

    %% SPACING %%

        \vspace{1in}
        \hspace{1in}

    %% URLS, EMAIL, AND LOCAL FILES %%

      \url{url}
      \href{url}{name}
      \href{mailto:mcocci@raidenlovessusie.com}{name}
      \href{run:/path/to/file.pdf}{name}


    %% INCLUDING PDF PAGE %%

        \includepdf{file.pdf}


    %% INCLUDING CODE %%

        %\verbatiminput{file.ext}
            %   Includes verbatim text from the file

        \texttt{text}
            %   Renders text in courier, or code-like, font

        \matlabcode{file.m}
            %   Includes Matlab code with colors and line numbers

        \lstset{style=bash}
        \begin{lstlisting}
        \end{lstlisting}
            % Inline code rendering


    %% INCLUDING FIGURES %%

        % Basic Figure with size scaling
            \begin{figure}[h!]
               \centering
               \includegraphics[scale=1]{file.pdf}
            \end{figure}

        % Basic Figure with specific height
            \begin{figure}[h!]
               \centering
               \includegraphics[height=5in, width=5in]{file.pdf}
            \end{figure}

        % Figure with cropping, where the order for trimming is  L, B, R, T
            \begin{figure}
               \centering
               \includegraphics[trim={1cm, 1cm, 1cm, 1cm}, clip]{file.pdf}
            \end{figure}

        % Side by Side figures: Use the tabular environment


